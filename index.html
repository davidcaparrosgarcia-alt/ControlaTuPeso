<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ControlaTuPeso+</title>

  <!-- PWA y Metadatos -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="iconos/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="iconos/icono-192.png">
  <meta name="theme-color" content="#1f2937">

  <!-- Librerías Externas (CDNs) - USANDO VERSIONES DE PRODUCCIÓN -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script> tailwind.config = { darkMode: 'class', theme: { extend: { colors: { 'slate': { 700: '#334155', 800: '#1e293b', 900: '#0f172a' } }, fontFamily: { sans: ['Inter', 'sans-serif'], handwriting: ['Caveat', 'cursive'] } } } } </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <!-- Fuentes de Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@500&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Estilos y Script de Errores -->
  <style>
    body { font-family: 'Inter', sans-serif; }
    .elevated-border{border:2px solid rgba(107,114,128,.8)}
    .dark .elevated-border{border-color:rgba(75,85,99,.9)}
    .btn-ghost{border:2px solid rgba(156,163,175,.8)}
    .calendar-cell{border:2px solid rgba(156,163,175,.8)}
    .dark .calendar-cell{border-color:rgba(75,85,99,.9)}
    .tooltip{position:absolute; left:50%; transform:translateX(-50%); bottom:calc(100% + .5rem); background:#111827; color:#fff; padding:.75rem; font-size:.8rem; border-radius:.5rem; box-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1); display:none; width:280px; max-width:90vw; z-index: 60; text-align:left;}
    .tooltip-wrap:hover .tooltip{display:block}
    @media (max-width: 480px){ .tooltip{left:0; transform:none} }
    .splash { position: fixed; inset: 0; z-index: 9999; background-color: #000; transition: opacity 0.5s ease-out, visibility 0.5s ease-out; display: flex; align-items: center; justify-content: center; }
    .splash-video { width: 100%; height: 100%; object-fit: contain; }
    .splash-hidden { opacity: 0; visibility: hidden; }
  </style>
  <script>
    window.onerror = function(msg, src, line, col, err){
      console.error('WINDOW ONERROR:', { msg, src, line, col, err });
      const splash = document.getElementById('animated-splash');
      if (splash) { splash.remove(); }
      const root = document.getElementById('root');
      if(root){
        root.innerHTML = '<div style="padding:16px;font-family:sans-serif;color:#b91c1c;background:#fee2e2;border:2px solid #ef4444;border-radius:12px">'+
          '<h3>Se ha producido un error en la app</h3>'+
          '<div><b>Mensaje:</b> '+String(msg)+'</div>'+
          '<div><b>Archivo:</b> '+String(src)+'  <b>Línea:</b> '+String(line)+':'+String(col)+'</div>'+
          '<pre style="white-space:pre-wrap;margin-top:8px">'+(err && err.stack ? err.stack : '')+'</pre>'+
          '<div style="margin-top:8px;font-size:12px;color:#111">Sugerencia: asegúrate de estar conectado a Internet para cargar las librerías. Revisa la Consola (F12) para más detalles.</div>'+
        '</div>';
      }
    };
  </script>
</head>
<body class="bg-gray-50 dark:bg-slate-900">

  <div id="animated-splash" class="splash">
    <video autoplay muted playsinline id="splash-video" class="splash-video">
      <source src="videos/intro.webm" type="video/webm"/>
      <source src="videos/intro.mp4" type="video/mp4"/>
      Tu navegador no soporta vídeos.
    </video>
  </div>

  <div id="root"></div>

  <script type="text/babel" data-presets="env,react">
    // ====================== Constantes y Utilidades ======================
    const USERS_KEY = 'health_tracker_users';
    const CURRENT_KEY = 'health_tracker_current';
    const THEME_KEY = 'health_tracker_theme';
    const SCENARIO_KEY = 'health_tracker_scenario';
    const MASTER_PIN = '0987';

    const EXERCISE_TIME = [ {value:'0min', label:'Sin ejercicio'}, {value:'30min', label:'30m'}, {value:'1h', label:'1h'}, {value:'1h30', label:'1h 30m'}, {value:'2h', label:'2h'}, {value:'+2h', label:'+2h'} ];
    const EXERCISE_TYPE = [ {value:'fuerza', label:'Fuerza'}, {value:'anaerobico', label:'Anaeróbico'} ];
    const SLEEP = [ {value:'<6h', label:'Menos de 6h'}, {value:'6h', label:'6 horas'}, {value:'7h', label:'7 horas'}, {value:'8h', label:'8 horas'}, {value:'+8h', label:'Más de 8h'}, ];
    const FASTING = [ {value:'0h', label:'Sin ayuno'}, {value:'12h', label:'12/12'}, {value:'14h', label:'14/10'}, {value:'16h', label:'16/8'}, {value:'20h', label:'20/4'}, {value:'24h', label:'24 horas'}, ];
    const DIET = [ {value:'estricta', label:'Estricta'}, {value:'correcta', label:'Correcta'}, {value:'incorrecta', label:'Incorrecta'}, {value:'mala', label:'Autodestrucción'}, ];
    const WATER = [ {value:'0.5L', label:'0,5 L'}, {value:'1L', label:'1 L'}, {value:'1.5L', label:'1,5 L'}, {value:'2L', label:'2 L'}, {value:'+2L', label:'Más de 2 L'}, ];

    const fmt = (d) => { const y = d.getFullYear(), m = String(d.getMonth() + 1).padStart(2, '0'), day = String(d.getDate()).padStart(2, '0'); return `${y}-${m}-${day}`; };
    const sleepHours = c => c === '<6h' ? 5.5 : c === '+8h' ? 9 : parseFloat((c || '7h').replace('h', '')) || 7;
    const exerciseHours = c => c === '0min' ? 0 : c === '30min' ? 0.5 : c === '1h' ? 1 : c === '1h30' ? 1.5 : c === '2h' ? 2 : c === '+2h' ? 2.5 : 0;
    const waterLiters = c => c === '+2L' ? 2.5 : parseFloat((c || '1.5L').replace('L', '').replace(',', '.')) || 1.5;
    const humanizeDays = (n) => {
      if (!isFinite(n) || n < 0) return '—'; if (n < 1) return '¡Hoy!'; const days = Math.round(n); if (days < 30) return `${days} día${days > 1 ? 's' : ''}`; const months = Math.floor(days / 30); const remDays = days % 30; if (remDays === 0) return `${months} ${months === 1 ? 'mes' : 'meses'}`; return `${months} ${months === 1 ? 'mes' : 'meses'} y ${remDays} día${remDays > 1 ? 's' : ''}`;
    };
    
    // ====================== Iconos SVG Como Componentes de React (Bloque Completo y Verificado vFinal) ======================
    const MedicalVisitIcon = ({ className, ...props }) => ( <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}><g transform="translate(0,512) scale(0.1,-0.1)" fill="currentColor" stroke="none"><path d="M1665 4643 c-27 -2 -90 -13 -139 -25 -81 -20 -110 -38 -92 -56 4 -3 82 -13 174 -22 l167 -15 0 -90 0 -90 -185 0 -184 0 -14 88 c-14 87 -14 89 8 119 22 30 22 32 5 45 -25 17 -34 17 -73 -7 -39 -24 -57 -63 -67 -146 -6 -59 -8 -61 -43 -74 -102 -36 -194 -126 -247 -242 -97 -211 -60 -531 81 -704 l33 -41 -30 -28 c-93 -90 -89 -200 12 -306 24 -26 174 -168 334 -315 381 -354 557 -523 574 -554 8 -15 17 -69 21 -131 8 -150 31 -179 141 -179 l49 0 -6 -152 c-4 -84 -7 -154 -8 -155 -1 -1 -179 -5 -396 -9 -262 -4 -420 -11 -468 -20 -258 -47 -442 -265 -442 -521 0 -201 116 -383 300 -472 150 -73 270 -87 590 -68 217 13 307 44 393 136 109 117 138 283 114 669 l-8 132 343 0 c390 0 816 15 898 31 175 35 309 185 318 357 4 71 5 72 32 72 43 0 135 36 195 76 73 48 120 103 162 191 124 258 -41 575 -309 591 -50 3 -71 0 -82 -10 -12 -13 -8 -17 38 -31 156 -50 264 -177 274 -323 7 -109 -17 -174 -89 -244 -31 -31 -83 -69 -115 -85 -51 -26 -70 -30 -139 -30 -67 0 -88 5 -131 27 -148 78 -223 276 -163 433 30 81 110 164 202 210 38 19 77 35 85 35 14 0 14 2 -1 18 -14 13 -35 17 -90 17 -59 0 -82 -5 -132 -29 -152 -75 -249 -251 -231 -418 26 -224 182 -396 391 -428 38 -6 71 -13 73 -14 1 -2 -7 -29 -18 -60 -46 -121 -124 -198 -239 -234 -61 -19 -190 -19 -933 -6 l-346 6 -6 32 c-3 17 -8 86 -12 154 l-7 122 58 0 c67 0 118 21 134 56 6 14 11 60 11 102 0 133 -5 125 258 382 231 225 597 602 669 688 27 32 37 54 41 91 4 43 1 52 -28 84 -18 20 -36 34 -41 31 -6 -3 -17 0 -26 8 -9 7 -3 -7 13 -32 57 -85 55 -96 -46 -185 -296 -262 -867 -796 -900 -843 -38 -51 -51 -97 -53 -186 l-2 -77 -93 3 -92 3 -4 92 c-5 150 -5 150 -378 509 -178 171 -389 373 -471 449 -85 81 -147 146 -147 157 0 24 67 97 96 104 28 7 24 11 544 -481 198 -188 351 -325 375 -336 52 -24 109 -24 164 1 32 15 154 132 463 442 l419 423 44 0 44 0 -20 20 c-13 14 -33 20 -63 20 -49 0 -60 -7 -316 -219 -161 -134 -277 -236 -487 -433 -86 -80 -150 -133 -163 -133 -21 0 -20 -1 -530 480 -177 168 -341 317 -364 332 -53 36 -111 44 -159 24 l-37 -15 -13 32 c-26 62 -57 194 -65 277 -20 194 30 347 159 491 l48 54 26 -32 c47 -59 90 -67 308 -59 214 8 247 16 281 75 21 36 33 170 22 245 -15 101 -88 139 -241 129z m507 -3460 c-1 -126 -7 -258 -12 -295 -24 -163 -103 -251 -256 -283 -54 -11 -120 -13 -304 -9 -323 8 -384 25 -489 140 -72 78 -95 144 -95 269 0 128 23 191 101 275 67 73 141 111 232 120 36 4 237 8 446 9 l380 1 -3 -227z"/><path d="M2930 4640 c-106 -9 -208 -37 -220 -61 -13 -24 -7 -25 182 -40 93 -7 159 -17 161 -23 2 -6 1 -47 -2 -91 l-6 -80 -185 0 -185 0 -8 55 c-15 104 -13 136 8 160 19 21 19 22 0 36 -24 17 -29 17 -64 0 -42 -22 -60 -57 -71 -138 -19 -128 5 -208 72 -245 29 -16 57 -18 230 -16 222 1 257 8 306 62 l32 35 40 -39 c179 -175 217 -446 110 -776 -31 -94 -37 -139 -20 -139 25 0 91 42 113 72 34 46 50 80 83 178 26 76 29 99 29 210 0 134 -19 221 -70 320 -56 109 -145 195 -236 227 l-49 18 0 63 c0 94 -17 147 -57 182 -18 17 -41 30 -51 30 -9 0 -26 2 -37 4 -11 2 -58 0 -105 -4z"/><path d="M3650 2452 c-120 -120 -37 -312 135 -312 169 0 259 194 138 300 -27 25 -42 30 -70 28 -55 -5 -64 -30 -25 -66 37 -35 43 -79 14 -105 -22 -20 -73 -22 -90 -5 -21 21 -14 84 13 116 30 36 31 44 7 65 -33 30 -80 21 -122 -21z"/></g></svg> );
    const AnaerobicIcon = ({ className, ...props }) => ( <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}><g transform="translate(0,512) scale(0.1,-0.1)" fill="currentColor" stroke="none"><path d="M2585 4453 c-71 -10 -449 -95 -540 -121 -429 -125 -429 -125 -472 -164 -45 -41 -37 -127 14 -168 36 -28 46 -25 28 10 -40 77 -12 104 130 125 61 9 211 39 335 66 299 67 431 89 572 96 117 6 118 6 158 -22 46 -32 117 -111 216 -240 38 -49 101 -129 141 -177 40 -48 77 -97 84 -109 18 -34 4 -97 -27 -130 -52 -55 -131 -45 -192 23 -16 18 -114 128 -217 243 -103 116 -194 214 -203 219 -10 6 -51 4 -106 -3 -111 -15 -309 -41 -317 -41 -4 0 -29 -18 -55 -40 -88 -72 -198 -89 -375 -57 -155 28 -90 -35 81 -79 45 -11 91 -15 152 -12 77 4 96 9 160 42 65 33 87 39 203 51 72 8 147 17 167 20 l37 5 135 -157 135 -157 -60 -32 c-79 -43 -149 -96 -235 -180 -85 -83 -191 -207 -206 -240 -7 -15 -20 -24 -34 -24 -15 0 -36 -16 -61 -46 -21 -25 -73 -80 -117 -122 -184 -181 -361 -445 -461 -692 -25 -61 -31 -68 -113 -125 -110 -76 -346 -309 -440 -437 -40 -53 -98 -140 -131 -195 -39 -66 -64 -98 -75 -97 -14 2 -16 -5 -11 -40 5 -30 1 -53 -15 -89 -12 -27 -32 -91 -45 -143 -13 -53 -31 -105 -39 -117 -19 -27 -192 -256 -211 -279 -8 -10 -22 -14 -34 -11 -28 7 -27 31 5 195 14 72 36 192 49 267 21 120 27 137 53 164 27 26 40 31 109 37 133 11 142 32 27 63 -84 24 -122 21 -184 -10 -65 -33 -88 -73 -115 -196 -10 -45 -37 -161 -62 -257 -27 -109 -44 -199 -45 -237 -1 -109 48 -159 163 -169 84 -7 117 14 202 126 35 47 87 117 117 155 29 39 63 92 75 118 20 42 38 58 156 139 237 161 560 398 878 646 246 191 338 269 443 370 l87 85 133 -58 c73 -32 134 -58 135 -59 2 -1 -27 -38 -64 -82 -36 -43 -117 -145 -180 -226 -113 -145 -116 -147 -138 -132 -16 10 -34 13 -59 9 -52 -10 -61 -27 -25 -49 21 -12 42 -42 69 -99 21 -45 55 -107 75 -138 33 -50 38 -68 55 -195 11 -76 25 -163 31 -192 10 -48 9 -55 -8 -67 -10 -8 -21 -15 -25 -15 -3 0 -44 53 -89 117 -46 65 -121 171 -167 236 -119 167 -123 192 -40 282 47 51 68 95 47 95 -17 0 -92 -41 -132 -72 -50 -40 -77 -95 -77 -156 0 -54 19 -89 241 -438 86 -136 116 -175 143 -188 95 -45 221 13 256 118 9 29 6 70 -20 238 -32 216 -41 251 -66 280 -16 16 -15 18 7 27 169 65 297 131 438 225 142 95 351 265 384 313 41 60 57 108 57 172 0 108 -54 206 -188 341 -48 47 -136 124 -196 170 l-109 84 69 23 c96 33 234 102 333 167 47 31 88 56 93 56 12 0 72 -39 200 -130 62 -45 147 -98 188 -118 68 -34 82 -37 160 -37 70 0 94 4 135 24 99 49 124 86 290 424 84 172 174 364 199 427 57 146 100 294 92 323 -26 99 -142 155 -229 111 -52 -27 -243 -181 -276 -223 -51 -64 -83 -146 -89 -225 -5 -64 -12 -85 -75 -206 -39 -74 -72 -137 -73 -139 -2 -2 -45 23 -96 57 -51 33 -111 68 -133 78 -30 15 -41 26 -46 51 -3 18 -14 44 -23 57 -9 14 -16 27 -16 30 0 2 21 12 48 20 165 57 270 257 232 448 -31 159 -128 247 -281 256 -64 4 -77 2 -82 -12 -4 -10 -1 -18 6 -21 154 -47 234 -132 244 -259 10 -116 -38 -206 -138 -261 -70 -38 -170 -41 -235 -7 -98 51 -139 120 -139 237 0 132 53 213 179 275 36 18 66 36 66 41 0 17 -40 29 -97 29 -72 0 -133 -27 -192 -83 -40 -38 -101 -144 -101 -174 0 -26 -16 -11 -70 64 -74 103 -180 214 -238 251 -83 53 -186 72 -307 55z m2015 -488 c0 -9 -7 -32 -16 -53 -8 -20 -53 -136 -99 -258 -133 -349 -221 -535 -305 -648 -52 -71 -88 -90 -165 -90 -54 1 -75 8 -210 76 -82 41 -180 87 -217 103 l-67 28 74 69 c74 69 135 165 135 212 0 16 19 1 75 -61 94 -102 187 -173 226 -173 39 0 66 32 135 159 31 58 72 129 89 157 24 38 34 67 40 120 15 140 56 202 219 323 74 55 86 60 86 36z m-1140 -355 c30 -11 78 -19 106 -20 58 0 64 -7 64 -69 0 -72 -28 -140 -78 -190 -64 -63 -221 -165 -377 -247 -71 -37 -167 -89 -211 -116 -45 -26 -85 -48 -88 -48 -4 0 -50 25 -102 56 -52 31 -157 86 -234 123 l-139 67 42 35 c23 20 119 98 212 173 94 76 187 154 207 173 l38 35 42 -44 c24 -24 61 -52 83 -63 49 -23 160 -32 209 -15 48 15 132 93 148 136 6 18 14 34 18 34 3 -1 30 -9 60 -20z m-942 -660 c227 -113 410 -238 606 -413 192 -172 236 -255 190 -353 -17 -36 -184 -187 -355 -320 -134 -105 -396 -294 -407 -294 -5 0 -34 29 -64 65 l-55 65 239 237 c194 194 238 242 238 264 0 49 -37 71 -305 184 -201 84 -283 127 -340 177 -120 106 -119 243 5 410 59 80 39 81 248 -22z m-449 -358 c41 -80 133 -152 285 -223 l68 -32 -82 -43 c-124 -67 -269 -170 -497 -356 -114 -93 -286 -231 -382 -306 -229 -179 -329 -263 -424 -354 -87 -84 -86 -85 -67 41 6 47 5 74 -4 101 l-13 37 63 47 c35 25 132 119 216 209 231 245 342 351 426 408 91 60 95 66 123 149 31 93 118 275 191 397 l63 106 6 -69 c3 -42 14 -86 28 -112z"/></g></svg> );
    const DrinkIcon = ({ className, ...props }) => ( <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}><g transform="translate(0,512) scale(0.1,-0.1)" fill="currentColor" stroke="none"><path d="M3080 5059 c-25 -11 -60 -35 -78 -52 -54 -51 -66 -80 -146 -347 l-26 -86 -82 12 c-170 26 -362 12 -539 -40 -197 -57 -362 -157 -515 -310 -159 -159 -258 -327 -308 -528 l-23 -90 -50 -28 c-56 -32 -109 -102 -119 -158 -4 -20 -4 -115 -1 -212 6 -204 13 -229 85 -299 l49 -47 7 -89 c27 -359 176 -1479 290 -2182 36 -225 49 -284 74 -338 38 -81 102 -144 190 -187 l67 -33 600 0 600 0 50 23 c28 13 68 35 89 50 51 35 120 129 140 190 39 118 273 1771 342 2409 15 137 20 164 35 168 25 8 89 81 106 123 10 25 16 91 20 223 5 166 4 194 -12 235 -23 60 -73 115 -125 139 -28 13 -42 26 -46 44 -49 229 -143 411 -301 581 l-76 81 37 99 c84 227 146 417 146 450 0 86 -51 168 -124 201 -62 28 -293 27 -356 -2z m215 -241 c-4 -13 -20 -63 -35 -113 -16 -49 -40 -129 -54 -176 l-26 -86 -54 28 c-30 15 -60 29 -67 31 -9 3 3 49 45 163 31 88 63 163 69 167 7 4 38 8 70 8 56 0 58 -1 52 -22z m-546 -484 c4 -5 -18 -103 -50 -219 -32 -115 -73 -270 -91 -342 l-32 -133 -181 -1 c-99 0 -353 -4 -565 -8 -212 -4 -387 -6 -389 -5 -2 2 13 34 34 71 182 333 505 570 870 638 88 16 389 16 404 -1z m324 -106 c32 -16 38 -23 32 -41 -3 -12 -36 -140 -73 -284 l-66 -263 -129 0 c-99 0 -128 3 -124 13 3 6 39 95 80 197 41 102 96 240 122 307 l47 121 36 -15 c21 -8 54 -24 75 -35z m341 -241 c45 -45 108 -116 138 -157 58 -78 123 -188 116 -195 -7 -7 -559 8 -556 15 2 4 43 105 92 223 80 193 92 215 108 206 10 -5 56 -47 102 -92z m-734 -592 l1035 -4 8 -156 c8 -137 7 -159 -7 -174 -14 -15 -42 -19 -189 -25 -211 -8 -553 -31 -790 -52 -162 -14 -198 -14 -395 0 -119 8 -272 18 -339 22 l-122 7 -22 121 c-26 144 -34 166 -54 166 -26 0 -26 -21 0 -149 14 -68 23 -126 20 -129 -2 -3 -97 -1 -211 4 -188 8 -207 11 -220 29 -12 17 -14 47 -8 175 4 88 11 161 18 169 9 11 33 12 126 6 63 -4 581 -9 1150 -10z m195 -489 c231 -20 685 -46 786 -46 44 0 79 -4 79 -9 0 -5 -18 -83 -39 -173 -90 -375 -270 -1207 -356 -1648 -14 -74 -28 -140 -30 -147 -2 -7 -83 22 -219 79 -229 97 -277 127 -320 201 -13 23 -66 173 -116 332 -51 160 -100 306 -111 326 -44 87 -114 143 -238 189 -103 38 -152 63 -194 99 -67 59 -81 103 -146 440 -34 173 -61 320 -61 327 0 8 32 14 108 19 59 4 184 13 277 20 189 15 313 13 580 -9z m-1011 -75 l9 -53 -190 -190 -190 -190 -15 58 -15 59 186 188 c102 103 190 186 196 184 5 -2 14 -27 19 -56z m-259 -101 c-82 -82 -152 -146 -156 -142 -3 4 -12 29 -18 56 l-12 49 83 85 c46 46 92 88 103 92 11 5 49 9 85 9 l65 1 -150 -150z m-135 85 c-30 -30 -57 -55 -61 -55 -6 0 -29 78 -29 99 0 7 28 11 72 11 l72 0 -54 -55z m254 -406 c-203 -203 -194 -199 -209 -110 l-7 44 188 189 189 189 14 -62 13 -62 -188 -188z m214 51 l10 -55 -181 -182 c-100 -101 -184 -183 -188 -183 -3 0 -12 27 -19 61 l-13 61 184 184 c101 101 186 180 190 176 3 -4 11 -32 17 -62z m37 -199 l7 -44 -178 -178 c-98 -99 -181 -179 -185 -179 -3 0 -11 25 -18 56 l-13 57 183 183 c198 198 189 193 204 105z m67 -142 l26 -36 -207 -207 -208 -208 -12 63 -13 62 188 188 c104 104 191 185 194 181 3 -4 18 -23 32 -43z m112 -97 l45 -29 -254 -253 -253 -253 -11 52 c-6 29 -11 57 -11 64 0 9 428 447 437 447 1 0 22 -13 47 -28z m166 -68 c22 -9 40 -19 40 -23 0 -3 -141 -147 -314 -320 l-314 -314 -11 52 c-6 29 -11 60 -11 69 0 22 530 552 552 552 10 0 36 -7 58 -16z m132 -81 c15 -15 28 -32 28 -37 0 -21 -709 -721 -714 -705 -3 7 -9 34 -14 59 l-9 45 331 333 c182 182 335 332 340 332 6 0 23 -12 38 -27z m81 -145 l17 -53 -373 -373 -372 -372 -13 62 -12 63 362 362 c200 200 365 363 369 363 3 0 13 -24 22 -52z m53 -163 l18 -56 -379 -379 c-240 -240 -382 -375 -386 -368 -4 7 -11 34 -14 61 l-7 50 373 373 c206 206 375 374 376 374 1 0 10 -25 19 -55z m58 -180 l16 -50 -387 -387 c-213 -214 -391 -388 -394 -388 -3 0 -11 28 -17 63 l-10 62 381 382 c210 211 384 379 388 375 3 -4 14 -29 23 -57z m-328 -614 c-292 -292 -399 -392 -405 -382 -5 7 -11 34 -15 59 l-6 47 392 392 393 393 19 -56 18 -56 -396 -397z m458 312 l35 -38 -377 -377 c-298 -299 -382 -378 -402 -378 -21 0 -52 14 -80 37 -3 3 780 793 787 793 2 0 18 -17 37 -37z m131 -94 l48 -21 -344 -344 -344 -344 -67 0 c-38 0 -68 3 -68 7 0 9 712 723 721 723 4 0 28 -9 54 -21z m165 -70 l44 -20 -310 -309 -310 -310 -72 0 c-40 0 -72 3 -72 7 0 15 645 653 660 653 8 0 35 -10 60 -21z m153 -63 l49 -19 -279 -279 -278 -278 -75 0 -75 0 300 300 c165 165 302 299 305 298 3 -2 27 -12 53 -22z m57 -157 l-17 -91 -164 -164 -164 -164 -75 0 -75 0 255 255 c140 140 255 255 256 255 0 0 -7 -41 -16 -91z m-51 -259 c-20 -102 -86 -160 -181 -160 l-43 0 115 115 c63 63 116 113 118 111 2 -2 -2 -32 -9 -66z"/></g></svg> );
    const AnalysisIcon = ({ className, ...props }) => ( <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}><g transform="translate(0,512) scale(0.1,-0.1)" fill="currentColor" stroke="none"><path d="M3231 4740 c-137 -28 -256 -169 -300 -355 l-12 -50 -173 3 c-217 4 -206 14 -206 -170 l0 -128 -282 0 c-156 -1 -302 -5 -325 -9 -50 -10 -143 -71 -185 -121 -60 -73 -99 -185 -118 -337 -8 -63 -7 -129 5 -272 8 -105 15 -215 15 -245 l0 -56 -77 -39 c-455 -229 -662 -775 -474 -1246 18 -44 42 -95 53 -113 l21 -34 -35 -28 c-45 -38 -68 -86 -68 -145 0 -40 -3 -48 -22 -53 -42 -10 -146 -69 -208 -117 -60 -46 -296 -263 -451 -415 -86 -84 -106 -127 -95 -214 15 -131 155 -237 290 -220 127 17 183 56 461 324 236 227 278 275 296 337 11 41 14 44 40 38 35 -8 93 10 134 40 l30 22 68 -26 68 -26 -7 -55 c-26 -203 -19 -322 25 -416 48 -103 129 -169 246 -200 40 -11 248 -14 1055 -14 1202 0 1678 16 1776 59 78 35 70 97 -15 108 -37 5 -41 8 -35 27 4 11 11 37 15 56 13 54 11 3197 -2 3243 -5 21 -24 54 -42 74 -57 65 -68 67 -400 71 l-298 4 2 130 c2 117 0 133 -16 145 -14 9 -55 13 -146 13 l-127 0 -12 48 c-57 229 -279 400 -469 362z m167 -131 c104 -52 180 -157 207 -288 20 -95 30 -101 174 -101 l117 0 -3 -147 c-4 -149 -18 -282 -31 -295 -27 -26 -663 -45 -995 -30 -114 5 -209 11 -211 13 -2 2 -7 109 -11 237 l-7 232 175 0 c201 0 201 0 211 82 18 141 82 252 175 300 71 37 120 37 199 -3z m-858 -788 c0 -60 3 -116 6 -125 15 -40 205 -56 664 -56 465 0 654 15 713 54 38 26 54 69 63 167 l7 69 294 0 295 0 29 -29 29 -29 0 -1612 0 -1612 -30 -30 -31 -30 -1002 6 c-551 3 -1148 9 -1326 12 -323 6 -324 7 -348 30 -22 23 -23 27 -23 211 l0 188 158 0 c186 1 272 19 421 91 260 124 444 332 535 605 122 367 35 713 -258 1027 -196 209 -494 329 -771 309 l-85 -6 0 408 c0 428 0 425 45 449 13 8 122 11 318 12 l297 0 0 -109z m-420 -862 c292 -36 543 -212 685 -482 66 -126 86 -201 92 -349 8 -173 -18 -300 -90 -443 -113 -227 -290 -377 -534 -452 -80 -24 -103 -27 -253 -27 -191 -1 -242 10 -387 79 -545 263 -667 991 -238 1420 140 140 320 229 520 255 88 11 112 11 205 -1z m-845 -1534 c20 -24 68 -69 106 -101 60 -49 67 -59 58 -75 -52 -98 -259 18 -259 145 0 40 22 76 46 76 7 0 29 -20 49 -45z m-106 -236 c46 -50 52 -62 47 -86 -8 -30 -368 -395 -528 -535 -102 -88 -134 -99 -201 -70 -55 25 -88 69 -89 122 -1 54 19 80 142 190 58 51 152 139 210 195 58 56 130 120 160 143 66 49 166 102 189 101 9 -1 40 -28 70 -60z"/><path d="M3233 4500 c-61 -37 -62 -134 -2 -184 56 -47 145 -22 175 50 20 48 10 86 -32 124 -42 36 -93 40 -141 10z"/><path d="M2932 4084 c-27 -18 -29 -55 -4 -77 16 -15 53 -17 314 -17 273 0 296 1 311 18 23 26 21 58 -5 76 -19 14 -66 16 -308 16 -242 0 -289 -2 -308 -16z"/><path d="M2917 3092 c-26 -28 -21 -46 23 -85 112 -102 271 -133 525 -103 77 10 181 22 230 28 50 5 191 11 315 11 l225 2 9 28 c8 23 6 31 -12 50 -22 22 -27 22 -265 21 -172 0 -280 -5 -372 -18 -334 -45 -480 -30 -588 60 -34 29 -68 31 -90 6z"/><path d="M4045 2333 c-11 -3 -72 -26 -135 -51 -111 -45 -118 -46 -215 -45 -76 0 -124 7 -200 28 -141 39 -153 40 -175 20 -44 -39 -18 -72 80 -103 107 -35 206 -52 303 -52 78 0 105 5 177 31 216 79 222 81 267 74 24 -3 56 -17 72 -31 47 -39 101 -28 101 21 0 59 -96 115 -195 114 -33 -1 -69 -3 -80 -6z"/><path d="M3925 1514 c-11 -3 -78 -22 -150 -42 -122 -35 -139 -37 -265 -36 -86 0 -168 7 -225 18 -163 32 -180 32 -200 2 -16 -24 -16 -28 -2 -50 13 -20 34 -27 129 -45 258 -48 391 -47 580 8 206 59 269 63 366 21 55 -24 85 -18 97 20 10 30 -10 55 -62 81 -39 18 -68 23 -148 25 -55 2 -109 0 -120 -2z"/><path d="M2178 2644 c-17 -36 -4 -52 73 -94 83 -45 204 -166 247 -247 62 -118 89 -301 62 -418 -11 -49 8 -85 45 -85 53 0 71 57 69 220 -1 118 -21 199 -79 317 -56 113 -162 228 -271 291 -84 50 -128 55 -146 16z"/><path d="M2485 1720 c-25 -27 -10 -71 27 -84 53 -19 91 50 50 87 -25 23 -55 21 -77 -3z"/></g></svg> );
    const PillIcon = ({ className, ...props }) => ( <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}><g transform="translate(256,256)"><path d="M0 0 C1.621134 1.52381474 3.22608648 3.06507085 4.8125 4.625 C5.86244141 5.65560547 5.86244141 5.65560547 6.93359375 6.70703125 C21.58156387 22.09739362 28.46445366 43.58437377 27.99609375 64.60546875 C26.83648399 83.67734835 20.34528677 104.46000493 5.8125 117.625 C1.30577354 120.625 1.30577354 120.625 -1.1875 120.625 C-1.43113281 121.18703125 -1.67476563 121.7490625 -1.92578125 122.328125 C-3.42930936 125.06519785 -5.25449748 127.08295941 -7.375 129.375 C-8.58736328 130.69757813 -8.58736328 130.69757813 -9.82421875 132.046875 C-10.60410156 132.89765625 -11.38398438 133.7484375 -12.1875 134.625 C-13.35911061 135.95399114 -14.52623392 137.2869604 -15.6875 138.625 C-23.36561933 147.43018272 -31.26286957 156.04184744 -39.1875 164.625 C-39.99501709 165.50236816 -39.99501709 165.50236816 -40.81884766 166.39746094 C-49.39715975 175.70233119 -58.20773841 184.73947361 -67.22241211 193.62304688 C-70.79170235 197.15474303 -74.29945853 200.6809906 -77.56640625 204.49609375 C-81.83128384 209.46167401 -86.46770791 214.05500076 -91.1027832 218.6706543 C-92.62241668 220.1849258 -94.13662517 221.7044743 -95.65039062 223.22460938 C-96.64030459 224.21386239 -97.6305288 225.20280508 -98.62109375 226.19140625 C-99.49822021 227.06740479 -100.37534668 227.94340332 -101.27905273 228.84594727 C-103.39279079 230.90915688 -105.58808295 232.84315371 -107.83200073 234.7635498 C-112.35416396 238.71015998 -116.5734162 242.91287694 -120.78393555 247.18725586 C-121.60302902 248.01423477 -122.4221225 248.84121368 -123.26603699 249.69325256 C-125.03265405 251.47697566 -126.79822328 253.26173704 -128.56284142 255.04743767 C-131.36498934 257.88107246 -134.17189812 260.70993339 -136.98091125 263.53675842 C-137.94809636 264.51020328 -138.91528138 265.48364822 -139.88246632 266.45709324 C-140.36648053 266.94422358 -140.85049474 267.43135391 -141.34917605 267.93324578 C-147.87509206 274.50193282 -154.39638354 281.07510835 -160.90307617 287.6628418 C-165.31019258 292.12475063 -169.72640591 296.5774404 -174.15287811 301.02015024 C-176.48566529 303.36222808 -178.81230949 305.70990782 -181.13068199 308.06626701 C-199.72068543 326.95311227 -218.40739691 340.74430798 -246.125 341 C-269.90186327 340.75648234 -291.47951333 331.18992011 -308.3671875 314.640625 C-325.48855846 296.91912352 -333.62439706 273.48721757 -333.48779297 249.06787109 C-332.73765484 218.93394402 -315.8407509 199.06404565 -295.54321289 178.8503418 C-293.98660611 177.29915273 -292.43549829 175.74260608 -290.88476562 174.18554688 C-286.08944186 169.38736677 -281.24212322 164.7161445 -276.0847168 160.30395508 C-272.4491177 157.0866066 -269.08776923 153.58720492 -265.6875 150.125 C-260.92381576 145.27454555 -256.10575538 140.60088344 -250.95117188 136.16601562 C-248.75778876 134.24953802 -246.71516601 132.21505573 -244.6875 130.125 C-241.44493741 126.84396632 -238.11702978 123.77040004 -234.6171875 120.76953125 C-231.24205892 117.79051905 -227.96981102 114.70557563 -224.6875 111.625 C-220.27680994 107.48863597 -215.84880389 103.39864422 -211.265625 99.453125 C-207.82003872 96.42204534 -204.4706191 93.28673548 -201.10498047 90.16748047 C-197.82194709 87.12714317 -194.52056497 84.11064451 -191.1875 81.125 C-180.71730571 71.73385955 -170.45657751 62.10949862 -160.18945312 52.49755859 C-158.12332862 50.56497628 -156.05381346 48.63606393 -153.984375 46.70703125 C-146.2577749 39.48726655 -138.66937431 32.16329652 -131.22973633 24.64794922 C-127.62857668 21.02296015 -123.96196832 17.56501827 -120.046875 14.27734375 C-117.77539243 12.25877836 -115.7233509 10.07278256 -113.625 7.875 C-82.89201814 -22.95182303 -34.26407438 -29.98106508 0 0 Z" fill="#A7E991" transform="translate(406.1875,95.375)"/></g></svg> );
    const StarIcon = ({ className, ...props }) => ( <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}><g transform="translate(256,256)"><path d="M0 0 C8.29125932 4.07025458 10.95321634 10.78538864 13.80859375 19.04296875 C14.16728546 20.05392609 14.52597717 21.06488342 14.89553833 22.10647583 C15.67465857 24.30584459 16.44930283 26.50680291 17.22000122 28.70913696 C18.45857836 32.24772033 19.70891584 35.78194464 20.96264648 39.31518555 C22.28647812 43.04639037 23.61001849 46.77768872 24.92927551 50.51051331 C29.32610424 62.94913427 33.79128444 75.36274637 38.28079224 87.76821899 C39.494787 91.12525459 40.70457246 94.48378085 41.91381836 97.8425293 C50.38644763 121.31082028 59.21224325 144.64836503 68 168 C68.81391268 167.99631283 69.62782536 167.99262566 70.46640205 167.98882675 C90.27162886 167.90048543 110.07682169 167.8342951 129.88220406 167.79275131 C139.45995281 167.77212699 149.03757004 167.74400885 158.61523438 167.69824219 C166.96323353 167.65837047 175.31113743 167.63256624 183.65922916 167.62364602 C188.0794287 167.61843183 192.49935573 167.60617936 196.91946793 167.57707977 C201.08092147 167.54990533 205.24199055 167.54155906 209.4035244 167.54756927 C210.92972974 167.54646994 212.4559481 167.5385279 213.98207664 167.5231781 C216.06925995 167.50321709 218.15499993 167.50808132 220.24221802 167.51898193 C221.99270289 167.51345118 221.99270289 167.51345118 223.7785511 167.50780869 C228.53010628 168.23377835 231.67069833 170.48734638 234.8125 174.0625 C237.64505898 178.6840436 237.93790273 183.75556057 237 189 C235.11930407 192.15933982 232.6678652 194.49413041 230 197 C229.35160156 197.66902344 228.70320313 198.33804688 228.03515625 199.02734375 C224.34262429 202.83686682 220.47703303 206.37108205 216.45703125 209.828125 C213.11857333 212.77913073 209.87509163 215.82730977 206.625 218.875 C201.59614889 223.58788616 196.53765487 228.25870711 191.3984375 232.8515625 C188.70940633 235.26030378 186.04196128 237.6918545 183.375 240.125 C179.62541659 243.53801491 175.84476588 246.90721031 172.015625 250.23046875 C169.71392236 252.25114956 167.45235621 254.31312618 165.1875 256.375 C160.7954932 260.34262578 156.2569253 264.09060538 151.65625 267.8125 C149.1931702 269.84091866 146.80723249 271.92640311 144.4375 274.0625 C138.98282934 278.96876571 133.25700686 283.54132715 127.40234375 287.9609375 C121.67880095 292.81896895 117.46623928 299.8628908 116.78515625 307.3671875 C116.05348013 328.49799378 123.00706324 350.23082051 127.65495682 370.68997192 C128.25414939 373.33078758 128.85072654 375.97218116 129.44650269 378.61376953 C135.52970775 405.57757616 141.85750745 432.4761217 148.49121094 459.30981445 C148.79004684 460.52421707 149.08888275 461.73861969 149.39677429 462.98982239 C149.94676812 465.22213761 150.50063797 467.4535035 151.05940247 469.68363953 C155.24170776 486.65858273 155.24170776 486.65858273 151 494 C147.5958945 497.4041055 143.99730188 499.96966369 139.04614258 500.01977539 C132.86582762 499.5393341 128.95799567 497.65694062 123.9375 494.125 C123.20781006 493.63177246 122.47812012 493.13854492 121.72631836 492.63037109 C119.47334353 491.10216508 117.23697357 489.55149741 115 488 C113.66014598 487.09184119 112.31904456 486.18551939 110.9765625 485.28125 C92.19264605 472.57379481 73.94047129 459.02572072 55.8449707 445.36181641 C47.03169553 438.71008189 38.06560582 432.30273574 29 426 C28.22188965 425.45666016 27.4437793 424.91332031 26.64208984 424.35351562 C8.75737878 409.92174936 8.75737878 409.92174936 -11.84375 402.6015625 C-16.68764479 403.49663002 -20.81603091 406.52649073 -25 409 C-26.19680525 409.6645217 -27.3961462 410.32449201 -28.59765625 410.98046875 C-38.44342845 416.37312701 -47.90850987 422.28604645 -57.36621094 428.32714844 C-61.10152918 430.69963644 -64.8581607 433.03735762 -68.61474609 435.37597656 C-93.10166849 450.62022769 -117.31090394 466.29402242 -141.36647034 482.20915222 C-144.29491993 484.1459419 -147.22551501 486.07947247 -150.15621948 488.0128479 C-151.58339505 488.95578118 -153.00945937 489.90039874 -154.43435669 490.84677124 C-156.42885421 492.17142719 -158.42693022 493.49051959 -160.42578125 494.80859375 C-161.01736023 495.20363098 -161.60893921 495.59866821 -162.21844482 496.00567627 C-167.86949745 499.71715972 -172.15645162 501.69595407 -179 501 C-185.1680484 499.00375178 -189.41041533 495.35332523 -193 490 C-195.78650075 481.64049775 -192.84319587 474.46512707 -190.0625 466.5 C-189.61843722 465.20247033 -189.17510569 463.90469023 -188.73242188 462.60668945 C-187.46048 458.89437869 -186.16855267 455.18929757 -184.87091064 451.48590088 C-183.96110267 448.88897266 -183.05442469 446.29096428 -182.14794922 443.69287109 C-154.40037345 364.26336115 -154.40037345 364.26336115 -140.52612305 330.96240234 C-135.89287099 320.75663229 -135.89287099 320.75663229 -135.73046875 309.91796875 C-140.05914113 301.80605992 -145.54886978 295.43787447 -152 289 C-152.886875 288.11054688 -153.77375 287.22109375 -154.6875 286.3046875 C-156.36976258 284.62755377 -158.05584638 282.95424246 -159.74609375 281.28515625 C-161.69409066 279.31015072 -163.51745186 277.30009965 -165.3125 275.1875 C-172.25014967 267.09905536 -179.98938413 259.56363196 -188.109375 252.671875 C-190.33647079 250.70245971 -192.41214954 248.61625658 -194.5 246.5 C-197.74596318 243.21552539 -201.07648948 240.13847008 -204.58203125 237.13671875 C-207.89664297 234.20765153 -211.09523461 231.16017113 -214.3125 228.125 C-219.47746473 223.26505538 -224.75796936 218.66580164 -230.2890625 214.22265625 C-233.4461416 211.63421531 -236.5216375 208.97341233 -239.5625 206.25 C-240.07578857 205.80180908 -240.58907715 205.35361816 -241.11791992 204.8918457 C-245.44297331 200.96919067 -246.80961218 197.93560948 -247.375 192.1875 C-247.21319971 186.8278653 -245.18734172 182.42696624 -241.609375 178.45703125 C-235.09884253 172.614685 -227.99106254 172.66047285 -219.71582031 172.49755859 C-218.02150879 172.45322945 -218.02150879 172.45322945 -216.29296875 172.40800476 C-212.55484914 172.31252628 -208.81656525 172.23031856 -205.078125 172.1484375 C-202.45853962 172.08475126 -199.83897185 172.02033723 -197.21942139 171.95523071 C-191.71509927 171.81974708 -186.21065059 171.69121935 -180.70605469 171.56738281 C-173.72471533 171.41028993 -166.74369726 171.24195999 -159.76271439 171.06982994 C-154.34022546 170.93622177 -148.91763633 170.80690566 -143.49501801 170.67866898 C-140.92636481 170.61785674 -138.35772507 170.55647279 -135.78910065 170.49445724 C-118.85639767 170.09023895 -101.93750572 169.91853417 -85 170 C-84.706681 169.00030748 -84.706681 169.00030748 -84.40743637 167.98041916 C-84.14534504 167.09539341 -83.88325371 166.21036766 -83.61322021 165.29852295 C-83.35579922 164.42581127 -83.09837822 163.55309959 -82.83315659 162.65394211 C-81.50038919 158.40853666 -79.83169222 154.31619406 -78.140625 150.203125 C-77.76365479 149.27677246 -77.38668457 148.35041992 -76.99829102 147.39599609 C-75.75427248 144.34508666 -74.50264365 141.2973774 -73.25 138.25 C-72.81570679 137.18954468 -72.38141357 136.12908936 -71.93395996 135.03649902 C-56.9415026 98.43770508 -41.39315135 62.04981643 -25.52679443 25.82104492 C-24.04069917 22.4254291 -22.59155488 19.01931378 -21.1875 15.58886719 C-20.73238037 14.49782181 -20.73238037 14.49782181 -20.26806641 13.38473511 C-19.69123446 12.00086275 -19.12500599 10.61250084 -18.57177734 9.21902466 C-14.76895541 0.19095677 -9.11188872 -1.3265838 0 0 Z" stroke="currentColor" fill="none" strokeWidth="16" transform="translate(262,8)"/></g></svg> );
    const TrashIcon = ({ className, ...props }) => ( <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className} {...props}> <path d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"/></svg> );
    const WeightlifterIcon = ({ className, ...props }) => ( <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" className={className} {...props}> <path fillRule="evenodd" fill="currentColor" d="M 71.5,-0.5 C 72.8333,-0.5 74.1667,-0.5 75.5,-0.5C 79.8872,24.1028 83.8872,48.7695 87.5,73.5C 103.456,71.4122 119.456,69.5789 135.5,68C 139.35,64.7414 143.85,63.2414 149,63.5C 153.256,63.474 157.256,64.474 161,66.5C 192.435,64.0945 223.935,63.0945 255.5,63.5C 287.065,63.0945 318.565,64.0945 350,66.5C 358.901,62.0634 367.401,62.5634 375.5,68C 390.903,69.4334 406.236,71.2668 421.5,73.5C 426.48,48.9549 430.813,24.2883 434.5,-0.5C 438.833,-0.5 443.167,-0.5 447.5,-0.5C 468.599,3.795 489.933,7.46167 511.5,10.5C 511.5,12.1667 511.5,13.8333 511.5,15.5C 501.196,72.9871 491.196,130.654 481.5,188.5C 455.654,184.582 429.987,179.915 404.5,174.5C 409.167,148.5 413.833,122.5 418.5,96.5C 417.624,95.7492 416.624,95.2492 415.5,95C 404.846,93.6496 394.18,92.4829 383.5,91.5C 383.667,126.835 383.5,162.168 383,197.5C 382.08,200.101 381.413,202.768 381,205.5C 364.58,230.007 347.914,254.34 331,278.5C 326.523,292.095 322.357,305.761 318.5,319.5C 342.193,326.174 365.859,333.007 389.5,340C 392.58,342.29 395.747,344.457 399,346.5C 403.788,352.317 405.788,358.984 405,366.5C 398,408.5 391,450.5 384,492.5C 381.874,501.447 376.707,507.78 368.5,511.5C 364.5,511.5 360.5,511.5 356.5,511.5C 346.437,507.927 341.103,500.76 340.5,490C 346.015,453.741 352.015,417.575 358.5,381.5C 327.168,380.612 295.835,380.779 264.5,382C 235.116,402.695 206.449,424.361 178.5,447C 142.237,468.794 105.904,490.294 69.5,511.5C 65.5,511.5 61.5,511.5 57.5,511.5C 44.7211,505.943 39.8878,496.276 43,482.5C 44.0804,480.004 45.4138,477.67 47,475.5C 79.9034,454.936 113.07,434.77 146.5,415C 167.667,391.167 188.833,367.333 210,343.5C 210.781,342.271 211.281,340.938 211.5,339.5C 204.767,318.802 197.934,298.135 191,277.5C 169.954,252.122 149.287,226.456 129,200.5C 127.519,164.228 127.019,127.895 127.5,91.5C 115.43,92.4522 103.43,93.9522 91.5,96C 96.6478,123.053 101.314,150.219 105.5,177.5C 79.8456,181.609 54.1789,185.609 28.5,189.5C 19.3533,132.949 9.68663,76.6161 -0.5,20.5C -0.5,17.8333 -0.5,15.1667 -0.5,12.5C 23.6544,8.36475 47.6544,4.03142 71.5,-0.5ZM255.5,213.5C287.721,209.061 301.555,190.728 297,158.5C288.407,135.106 271.573,124.772 246.5,127.5C227.963,132.54 216.796,144.54 213,163.5C211.836,193.171 226.003,209.838 255.5,213.5Z M 216.5,85.5 C 257.851,85.2267 299.185,85.8934 340.5,87.5C 340.833,119.174 340.5,150.84 339.5,182.5C 318.978,199.523 298.312,216.356 277.5,233C 262.833,233.667 248.167,233.667 233.5,233C 212.667,216.167 191.833,199.333 171,182.5C 170.5,150.835 170.333,119.168 170.5,87.5C 186.01,87.2969 201.343,86.6303 216.5,85.5 Z" /></svg> );
    const MoonIcon = ({ ...props }) => ( <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" {...props}> <g><path style={{opacity:1}} fill="#fefefe" d="M -0.5,-0.5 C 340.833,-0.5 682.167,-0.5 1023.5,-0.5C 1023.5,340.833 1023.5,682.167 1023.5,1023.5C 682.167,1023.5 340.833,1023.5 -0.5,1023.5C -0.5,682.167 -0.5,340.833 -0.5,-0.5 Z"/></g> <g><path style={{opacity:1}} fill="#7d909c" d="M 511.5,140.5 C 522.34,139.176 533.34,139.176 544.5,140.5C 544.376,141.107 544.043,141.44 543.5,141.5C 533.013,140.506 522.346,140.172 511.5,140.5 Z"/></g> <g><path style={{opacity:1}} fill="#425660" d="M 497.5,141.5 C 491.712,142.81 485.712,143.477 479.5,143.5C 485.274,142.054 491.274,141.388 497.5,141.5 Z"/></g> <g><path style={{opacity:1}} fill="#012c49" d="M 511.5,140.5 C 522.346,140.172 533.013,140.506 543.5,141.5C 512.083,151.909 482.75,166.409 455.5,185C 448.951,190.097 442.285,194.93 435.5,199.5C 431.324,199.168 427.824,200.502 425,203.5C 424.667,203.167 424.333,202.833 424,202.5C 422.667,205.167 421.333,207.833 420,210.5C 416.766,213.015 413.433,215.349 410,217.5C 409.316,218.784 409.483,219.951 410.5,221C 409.244,221.417 408.577,222.25 408.5,223.5C 340.481,292.956 308.648,376.622 313,474.5C 320.859,576.743 366.026,657.909 448.5,718C 488.561,745.523 532.228,765.857 579.5,779C 584.827,779.943 590.16,780.777 595.5,781.5C 601.911,783.344 608.578,784.344 615.5,784.5C 663.104,787.478 709.104,780.312 753.5,763C 780.12,751.857 805.454,738.357 829.5,722.5C 830.391,721.89 831.391,721.557 832.5,721.5C 833.492,721.328 834.158,721.662 834.5,722.5C 797.065,777.097 748.398,818.597 688.5,847C 603.984,885.649 516.651,892.982 426.5,869C 370.022,852.115 320.355,823.948 277.5,784.5C 278.329,782.067 277.829,779.733 276,777.5C 272.966,776.399 270.133,774.899 267.5,773C 267.957,772.586 268.291,772.086 268.5,771.5C 266.076,769.697 264.409,767.363 263.5,764.5C 260.489,761.988 257.656,759.322 255,756.5C 253.334,757.34 253.167,756.84 254.5,755C 252.431,752.466 249.765,751.299 246.5,751.5C 243.899,748.396 241.066,745.396 238,742.5C 231.303,732.984 224.47,723.651 217.5,714.5C 173.96,644.685 154.294,568.351 158.5,485.5C 160.311,475.685 161.644,465.685 162.5,455.5C 162.5,454.167 162.5,452.833 162.5,451.5C 164.311,449.615 165.478,447.281 166,444.5C 166.499,440.848 166.665,437.182 166.5,433.5C 176.952,382.278 197.452,335.611 228,293.5C 235.322,283.683 243.155,274.35 251.5,265.5C 253.482,265.005 255.482,264.505 257.5,264C 258.851,262.383 260.518,261.216 262.5,260.5C 265.103,256.598 267.603,252.598 270,248.5C 270.741,247.359 271.575,247.359 272.5,248.5C 273.551,247.115 274.884,246.115 276.5,245.5C 277.795,243.672 278.795,241.672 279.5,239.5C 282.213,238.086 284.88,236.753 287.5,235.5C 287.281,234.325 287.614,233.325 288.5,232.5C 291.53,231.568 294.363,230.235 297,228.5C 297.348,225.042 298.848,222.209 301.5,220C 305.188,220.47 307.854,218.804 309.5,215C 309.167,214.667 308.833,214.333 308.5,214C 310.167,213.667 311.833,213.333 313.5,213C 314.223,210.982 315.223,209.148 316.5,207.5C 358.398,177.56 404.732,157.394 455.5,147C 463.366,145.078 471.366,143.912 479.5,143.5C 485.712,143.477 491.712,142.81 497.5,141.5C 502.07,140.559 506.737,140.226 511.5,140.5 Z"/></g> <g><path style={{opacity:1}} fill="#435c6c" d="M 718.5,169.5 C 717.71,168.391 717.21,167.058 717,165.5C 716.667,159.167 716.333,152.833 716,146.5C 715.825,151.019 715.325,155.353 714.5,159.5C 714.5,154.833 714.5,150.167 714.5,145.5C 715.5,145.5 716.5,145.5 717.5,145.5C 717.442,153.521 717.776,161.521 718.5,169.5 Z"/></g> <g><path style={{opacity:1}} fill="#4f6778" d="M 714.5,162.5 C 714.679,168.404 714.012,174.071 712.5,179.5C 712.596,173.627 713.263,167.96 714.5,162.5 Z"/></g> <g><path style={{opacity:1}} fill="#113047" d="M 435.5,199.5 C 426.455,207.551 417.455,215.551 408.5,223.5C 408.577,222.25 409.244,221.417 410.5,221C 409.483,219.951 409.316,218.784 410,217.5C 413.433,215.349 416.766,213.015 420,210.5C 421.333,207.833 422.667,205.167 424,202.5C 424.333,202.833 424.667,203.167 425,203.5C 427.824,200.502 431.324,199.168 435.5,199.5 Z"/></g> <g><path style={{opacity:1}} fill="#042c49" d="M 718.5,169.5 C 719.692,192.662 724.525,214.995 733,236.5C 743.674,260.17 761.507,275.67 786.5,283C 793.26,285.585 800.26,287.085 807.5,287.5C 810.577,288.856 813.91,289.689 817.5,290C 826.488,291.054 835.488,291.887 844.5,292.5C 851.52,292.901 858.52,293.568 865.5,294.5C 865.167,294.833 864.833,295.167 864.5,295.5C 854.856,296.25 845.189,296.916 835.5,297.5C 826.318,298.437 817.318,299.77 808.5,301.5C 760.571,308.596 732.071,335.929 723,383.5C 719.852,399.348 718.019,415.348 717.5,431.5C 716.676,435.312 716.176,439.312 716,443.5C 715.722,442.584 715.222,441.918 714.5,441.5C 714.509,416.744 711.342,392.41 705,368.5C 695.048,335.216 673.215,314.05 639.5,305C 615.469,299.662 591.136,296.162 566.5,294.5C 590.398,293.04 614.065,289.873 637.5,285C 667.896,277.924 689.062,260.091 701,231.5C 706.868,214.633 710.701,197.3 712.5,179.5C 714.012,174.071 714.679,168.404 714.5,162.5C 714.5,161.5 714.5,160.5 714.5,159.5C 715.325,155.353 715.825,151.019 716,146.5C 716.333,152.833 716.667,159.167 717,165.5C 717.21,167.058 717.71,168.391 718.5,169.5 Z"/></g> <g><path style={{opacity:1}} fill="#123148" d="M 316.5,207.5 C 315.223,209.148 314.223,210.982 313.5,213C 311.833,213.333 310.167,213.667 308.5,214C 308.833,214.333 309.167,214.667 309.5,215C 307.854,218.804 305.188,220.47 301.5,220C 298.848,222.209 297.348,225.042 297,228.5C 294.363,230.235 291.53,231.568 288.5,232.5C 287.614,233.325 287.281,234.325 287.5,235.5C 284.88,236.753 282.213,238.086 279.5,239.5C 278.795,241.672 277.795,243.672 276.5,245.5C 274.884,246.115 273.551,247.115 272.5,248.5C 271.575,247.359 270.741,247.359 270,248.5C 267.603,252.598 265.103,256.598 262.5,260.5C 260.518,261.216 258.851,262.383 257.5,264C 255.482,264.505 253.482,265.005 251.5,265.5C 267.095,247.069 284.429,230.569 303.5,216C 307.734,212.918 312.067,210.084 316.5,207.5 Z"/></g> <g><path style={{opacity:1}} fill="#d8e4ea" d="M 807.5,287.5 C 812.387,288.055 817.22,288.055 822,287.5C 829.596,289.324 837.096,290.99 844.5,292.5C 835.488,291.887 826.488,291.054 817.5,290C 813.91,289.689 810.577,288.856 807.5,287.5 Z"/></g> <g><path style={{opacity:1}} fill="#bdcfd8" d="M 835.5,297.5 C 826.814,300.047 817.814,301.381 808.5,301.5C 817.318,299.77 826.318,298.437 835.5,297.5 Z"/></g> <g><path style={{opacity:1}} fill="#042d49" d="M 681.5,442.5 C 685.982,443.326 690.649,443.826 695.5,444C 692.635,444.183 689.969,444.683 687.5,445.5C 684.833,445.5 682.167,445.5 679.5,445.5C 674.586,445.362 669.919,446.028 665.5,447.5C 653.92,448.645 642.92,451.812 632.5,457C 629.734,458.371 627.401,460.204 625.5,462.5C 615.779,470.242 609.279,480.242 606,492.5C 604.686,496.754 603.853,501.087 603.5,505.5C 601.434,516.64 599.934,527.974 599,539.5C 598.411,528.62 597.245,517.953 595.5,507.5C 595.483,505.435 595.15,503.435 594.5,501.5C 593.003,491.194 589.336,481.86 583.5,473.5C 577.77,464.301 569.77,457.968 559.5,454.5C 559.577,453.25 560.244,452.417 561.5,452C 560.5,451.667 559.5,451.333 558.5,451C 559.696,450.346 559.696,449.846 558.5,449.5C 555.004,450.61 551.671,450.11 548.5,448C 544.5,447.667 540.5,447.333 536.5,447C 538.595,446.444 538.762,445.944 537,445.5C 533.895,446.367 530.728,446.701 527.5,446.5C 516.912,444.758 516.912,443.092 527.5,441.5C 543.759,440.485 558.759,435.651 572.5,427C 586.224,414.209 594.057,398.375 596,379.5C 597.057,368.818 598.223,358.152 599.5,347.5C 600.712,362.242 602.545,376.909 605,391.5C 607.808,402.114 612.474,411.781 619,420.5C 631.689,431.758 646.522,438.591 663.5,441C 669.465,441.963 675.465,442.463 681.5,442.5 Z"/></g> <g><path style={{opacity:1}} fill="#798e9b" d="M 717.5,431.5 C 717.5,435.833 717.5,440.167 717.5,444.5C 716.5,444.5 715.5,444.5 714.5,444.5C 714.5,443.5 714.5,442.5 714.5,441.5C 715.222,441.918 715.722,442.584 716,443.5C 716.176,439.312 716.676,435.312 717.5,431.5 Z"/></g> <g><path style={{opacity:1}} fill="#2f4657" d="M 527.5,441.5 C 516.912,443.092 516.912,444.758 527.5,446.5C 522.167,446.167 516.833,445.833 511.5,445.5C 509.031,444.683 506.365,444.183 503.5,444C 506.365,443.817 509.031,443.317 511.5,442.5C 516.833,442.167 522.167,441.833 527.5,441.5 Z"/></g> <g><path style={{opacity:1}} fill="#334c60" d="M 166.5,433.5 C 166.665,437.182 166.499,440.848 166,444.5C 165.478,447.281 164.311,449.615 162.5,451.5C 162.99,445.191 164.323,439.191 166.5,433.5 Z"/></g> <g><path style={{opacity:1}} fill="#a7b0b4" d="M 511.5,442.5 C 509.031,443.317 506.365,443.817 503.5,444C 506.365,444.183 509.031,444.683 511.5,445.5C 508.5,445.5 505.5,445.5 502.5,445.5C 502.5,444.5 502.5,443.5 502.5,442.5C 505.5,442.5 508.5,442.5 511.5,442.5 Z"/></g> <g><path style={{opacity:1}} fill="#a8b1b6" d="M 681.5,442.5 C 686.5,442.5 691.5,442.5 696.5,442.5C 696.5,443.5 696.5,444.5 696.5,445.5C 693.5,445.5 690.5,445.5 687.5,445.5C 689.969,444.683 692.635,444.183 695.5,444C 690.649,443.826 685.982,443.326 681.5,442.5 Z"/></g> <g><path style={{opacity:1}} fill="#96afc1" d="M 679.5,445.5 C 675.409,446.895 671.076,447.562 666.5,447.5C 666.167,447.5 665.833,447.5 665.5,447.5C 669.919,446.028 674.586,445.362 679.5,445.5 Z"/></g> <g><path style={{opacity:1}} fill="#233e52" d="M 559.5,454.5 C 549.159,450.433 538.492,447.766 527.5,446.5C 530.728,446.701 533.895,446.367 537,445.5C 538.762,445.944 538.595,446.444 536.5,447C 540.5,447.333 544.5,447.667 548.5,448C 551.671,450.11 555.004,450.61 558.5,449.5C 559.696,449.846 559.696,450.346 558.5,451C 559.5,451.333 560.5,451.667 561.5,452C 560.244,452.417 559.577,453.25 559.5,454.5 Z"/></g> <g><path style={{opacity:1}} fill="#e4eff3" d="M 665.5,447.5 C 665.833,447.5 666.167,447.5 666.5,447.5C 664.854,450.569 662.187,452.069 658.5,452C 659.5,452.333 660.5,452.667 661.5,453C 659.782,453.346 658.115,453.846 656.5,454.5C 655.614,453.675 655.281,452.675 655.5,451.5C 645.527,453.443 636.361,457.443 628,463.5C 627.329,462.748 626.496,462.414 625.5,462.5C 627.401,460.204 629.734,458.371 632.5,457C 642.92,451.812 653.92,448.645 665.5,447.5 Z"/></g> <g><path style={{opacity:1}} fill="#405867" d="M 162.5,455.5 C 161.644,465.685 160.311,475.685 158.5,485.5C 158.865,475.235 160.199,465.235 162.5,455.5 Z"/></g> <g><path style={{opacity:1}} fill="#34515f" d="M 761.5,489.5 C 759.853,486.797 758.686,483.797 758,480.5C 757.768,481.737 757.268,482.737 756.5,483.5C 756.99,477.158 757.657,470.825 758.5,464.5C 759.72,472.811 760.72,481.145 761.5,489.5 Z"/></g> <g><path style={{opacity:1}} fill="#dce7eb" d="M 583.5,473.5 C 589.336,481.86 593.003,491.194 594.5,501.5C 593.275,500.063 592.275,498.396 591.5,496.5C 590.167,495.833 588.833,495.167 587.5,494.5C 587.959,488.682 586.626,483.182 583.5,478C 584.413,476.586 584.413,475.086 583.5,473.5 Z"/></g> <g><path style={{opacity:1}} fill="#072d49" d="M 761.5,489.5 C 764.651,506.817 774.651,517.984 791.5,523C 801.033,525.311 810.7,526.644 820.5,527C 807.091,527.173 794.091,529.506 781.5,534C 769.068,541.694 762.401,552.861 761.5,567.5C 759.896,571.9 759.229,576.566 759.5,581.5C 759.5,582.167 759.5,582.833 759.5,583.5C 758.833,582.5 758.167,581.5 757.5,580.5C 757.564,567.078 754.064,554.745 747,543.5C 742.075,538.287 736.241,534.454 729.5,532C 718.348,529.121 707.015,527.455 695.5,527C 705.26,526.271 714.927,524.937 724.5,523C 736.533,520.607 745.366,514.107 751,503.5C 753.656,497.05 755.489,490.383 756.5,483.5C 757.268,482.737 757.768,481.737 758,480.5C 758.686,483.797 759.853,486.797 761.5,489.5 Z"/></g> <g><path style={{opacity:1}} fill="#dde9ed" d="M 603.5,505.5 C 602.339,517.018 602.339,528.518 603.5,540C 602.281,543.345 600.114,544.179 597,542.5C 597.015,530.866 596.515,519.199 595.5,507.5C 597.245,517.953 598.411,528.62 599,539.5C 599.934,527.974 601.434,516.64 603.5,505.5 Z"/></g> <g><path style={{opacity:1}} fill="#b2c3c9" d="M 761.5,567.5 C 761.638,572.414 760.972,577.081 759.5,581.5C 759.229,576.566 759.896,571.9 761.5,567.5 Z"/></g> <g><path style={{opacity:1}} fill="#6f898f" d="M 757.5,580.5 C 758.167,581.5 758.833,582.5 759.5,583.5C 759.662,585.527 759.495,587.527 759,589.5C 757.608,586.722 757.108,583.722 757.5,580.5 Z"/></g> <g><path style={{opacity:1}} fill="#f1f2f2" d="M 854.5,703.5 C 856.705,700.423 858.372,697.09 859.5,693.5C 858.325,693.281 857.325,693.614 856.5,694.5C 853.276,699.668 849.61,704.335 845.5,708.5C 845.167,708.5 844.833,708.5 844.5,708.5C 840.906,710.297 837.24,712.13 833.5,714C 831.612,716.707 829.612,719.207 827.5,721.5C 825.199,720.94 822.866,720.44 820.5,720C 823.122,716.043 826.122,712.376 829.5,709C 835.936,707.516 841.603,704.516 846.5,700C 847.264,697.931 847.764,695.764 848,693.5C 851.195,691.665 854.028,689.998 856.5,688.5C 857.593,690.77 859.093,691.103 861,689.5C 862.28,689.613 863.113,690.28 863.5,691.5C 872.482,692.332 881.482,692.832 890.5,693C 891.5,694.667 892.5,696.333 893.5,698C 890.331,699.459 886.998,700.292 883.5,700.5C 877.254,699.949 871.087,698.949 865,697.5C 863.354,699.141 862.354,698.807 862,696.5C 860.456,698.468 859.289,700.635 858.5,703C 857.207,703.49 855.873,703.657 854.5,703.5 Z"/></g> <g><path style={{opacity:1}} fill="#98a0a2" d="M 854.5,703.5 C 853.833,704.167 853.167,704.833 852.5,705.5C 852.44,704.957 852.107,704.624 851.5,704.5C 849.754,706.252 847.754,707.585 845.5,708.5C 849.61,704.335 853.276,699.668 856.5,694.5C 857.325,693.614 858.325,693.281 859.5,693.5C 858.372,697.09 856.705,700.423 854.5,703.5 Z"/></g> <g><path style={{opacity:1}} fill="#636c6e" d="M 852.5,705.5 C 848.521,708.484 845.188,712.15 842.5,716.5C 841.17,717.832 839.503,718.665 837.5,719C 836.748,719.671 836.414,720.504 836.5,721.5C 835.833,721.833 835.167,722.167 834.5,722.5C 834.158,721.662 833.492,721.328 832.5,721.5C 836.84,717.493 840.84,713.16 844.5,708.5C 844.833,708.5 845.167,708.5 845.5,708.5C 847.754,707.585 849.754,706.252 851.5,704.5C 852.107,704.624 852.44,704.957 852.5,705.5 Z"/></g> <g><path style={{opacity:1}} fill="#b5babb" d="M 844.5,708.5 C 840.84,713.16 836.84,717.493 832.5,721.5C 831.391,721.557 830.391,721.89 829.5,722.5C 829.158,721.662 828.492,721.328 827.5,721.5C 829.612,719.207 831.612,716.707 833.5,714C 837.24,712.13 840.906,710.297 844.5,708.5 Z"/></g> <g><path style={{opacity:1}} fill="#a5abab" d="M 842.5,716.5 C 842.512,720.446 840.512,722.113 836.5,721.5C 836.414,720.504 836.748,719.671 837.5,719C 839.503,718.665 841.17,717.832 842.5,716.5 Z"/></g> <g><path style={{opacity:1}} fill="#e5f0f4" d="M 217.5,714.5 C 224.47,723.651 231.303,732.984 238,742.5C 241.066,745.396 243.899,748.396 246.5,751.5C 251.5,757.5 256.5,763.5 261.5,769.5C 260.883,769.611 260.383,769.944 260,770.5C 257.782,768.908 256.115,766.908 255,764.5C 254.282,765.451 253.449,765.617 252.5,765C 250.743,762.154 248.743,759.488 246.5,757C 245.552,756.517 244.552,756.351 243.5,756.5C 242.805,752.447 241.139,748.781 238.5,745.5C 237.167,745.167 235.833,744.833 234.5,744.5C 232.432,741.843 231.099,738.843 230.5,735.5C 226.499,732.354 223.999,728.354 223,723.5C 222.667,724.167 222.333,724.833 222,725.5C 221.19,723.694 220.024,722.194 218.5,721C 218.645,720.228 218.978,719.561 219.5,719C 218.418,717.67 217.751,716.17 217.5,714.5 Z"/></g> <g><path style={{opacity:1}} fill="#143146" d="M 246.5,751.5 C 249.765,751.299 252.431,752.466 254.5,755C 253.167,756.84 253.334,757.34 255,756.5C 257.656,759.322 260.489,761.988 263.5,764.5C 264.409,767.363 266.076,769.697 268.5,771.5C 268.291,772.086 267.957,772.586 267.5,773C 270.133,774.899 272.966,776.399 276,777.5C 277.829,779.733 278.329,782.067 277.5,784.5C 272.167,779.5 266.833,774.5 261.5,769.5C 256.5,763.5 251.5,757.5 246.5,751.5 Z"/></g> <g><path style={{opacity:1}} fill="#b2c4cd" d="M 595.5,781.5 C 602.422,781.656 609.089,782.656 615.5,784.5C 608.578,784.344 601.911,783.344 595.5,781.5 Z"/></g> </svg> );
    const InjectionIcon = ({ className, ...props }) => ( <svg id="Icons" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg" className={`w-6 h-6 ${className}`} {...props}><path fill="#d6dbe3" d="M16.622,48.248a.5.5,0,0,1-.38-.824l1.391-1.63-2.654,1.531a.5.5,0,0,1-.6-.787l1.376-1.371-1.858,1.072a.5.5,0,0,1-.626-.761l1.809-2.068-2.353,1.359a.5.5,0,0,1-.587-.8l.7-.639-.377.217a.5.5,0,0,1-.627-.105.5.5,0,0,1-.018-.635l2.141-2.742a.39.39,0,0,1-.036-.054.5.5,0,0,1,.183-.683l.866-.5a.5.5,0,0,1,.644.74L14.184,41.4l2.132-1.231a.5.5,0,0,1,.587.8l-.7.636.984-.569a.5.5,0,0,1,.626.762l-1.809,2.068,2.551-1.472a.5.5,0,0,1,.6.787l-1.375,1.37,1.861-1.074a.5.5,0,0,1,.63.756l-1.391,1.631,1.076-.62a.5.5,0,0,1,.5.865l-3.592,2.074A.489.489,0,0,1,16.622,48.248Z"/><path fill="#d6dbe3" d="M41.43,31.943a.5.5,0,0,1-.336-.87l1.285-1.168L39.69,31.457a.5.5,0,0,1-.548-.834L41.183,29.1,37.8,31.058a.5.5,0,0,1-.564-.823l4.381-3.517-6.528,3.768a.5.5,0,0,1-.533-.844l.753-.517-1.787,1.031a.5.5,0,0,1-.534-.844l1.819-1.253-3,1.734a.5.5,0,0,1-.548-.834L36.8,24.842l-7.619,4.4a.5.5,0,0,1-.541-.839L34.2,24.423l-7.455,4.3a.5.5,0,0,1-.525-.85l1.688-1.116-2.691,1.553a.5.5,0,0,1-.535-.842l6.091-4.236-6.383,3.685a.5.5,0,0,1-.526-.85l2.143-1.418L23.8,25.927a.5.5,0,0,1-.543-.838L30.431,19.9l-6.934,4a.5.5,0,0,1-.533-.844l4.1-2.822a.491.491,0,0,1-.516-.21.5.5,0,0,1,.109-.674l4.508-3.483a.487.487,0,0,1-.254-.181.5.5,0,0,1,.066-.664l3.171-2.9a.505.505,0,0,1,.246-.5l.866-.5a.5.5,0,0,1,.587.8l-.8.729,1.107-.638a.5.5,0,0,1,.556.828l-3.551,2.743,4.165-2.4a.5.5,0,0,1,.533.844l-3.841,2.64L38.33,14.18a.5.5,0,0,1,.543.838l-7.177,5.2,8.034-4.638a.5.5,0,0,1,.526.85l-2.137,1.414,2.458-1.419a.5.5,0,0,1,.535.843L35.021,21.5,41.767,17.6a.5.5,0,0,1,.525.85L40.6,19.574l1.991-1.149a.5.5,0,0,1,.541.839l-5.559,3.975,6.237-3.6a.5.5,0,0,1,.547.834L38.812,24.59l6.309-3.642a.5.5,0,0,1,.534.845l-1.818,1.253,2.145-1.238a.5.5,0,0,1,.534.844l-.757.52,1.008-.582a.5.5,0,0,1,.563.822L42.949,26.93l5.175-2.988a.5.5,0,0,1,.549.834l-2.511,1.869a.5.5,0,0,1,.334.87l-3.534,3.212a.5.5,0,0,1-.237.545l-1.045.6A.489.489,0,0,1,41.43,31.943Z"/><path fill="#8991a0" d="M44.773,21.233a.5.5,0,0,1-.337-.868l1.608-1.476-2.1,1.209a.5.5,0,0,1-.552-.831l4.12-3.123L42.741,18.9a.5.5,0,0,1-.53-.846l2.567-1.735-2.931,1.693a.5.5,0,0,1-.529-.848l2.06-1.383-2.389,1.379a.5.5,0,0,1-.537-.842l4.87-3.421-5.455,3.15a.5.5,0,0,1-.524-.851l.481-.316a.5.5,0,0,1-.386-.9l3.54-2.413a.494.494,0,0,1-.359-.226.5.5,0,0,1,.132-.678l2.9-2.046a.473.473,0,0,1-.133-.124.5.5,0,0,1,.061-.663l4.291-3.995a.5.5,0,0,1,.243-.515l.868-.5a.5.5,0,0,1,.59.8L49.478,5.56l2.694-1.555a.5.5,0,0,1,.539.841l-.485.342.719-.415a.5.5,0,0,1,.532.846l-2.4,1.634,2.76-1.593a.5.5,0,0,1,.524.851l-.137.091.355-.206a.5.5,0,0,1,.537.842L50.246,10.66,55.7,7.511a.5.5,0,0,1,.528.847L54.166,9.744l2.4-1.382a.5.5,0,0,1,.53.847l-2.985,2.016a.511.511,0,0,1,.489.218.5.5,0,0,1-.116.675l-4.7,3.568a.5.5,0,0,1,.293.866l-3.81,3.5a.5.5,0,0,1-.238.541l-1,.574A.491.491,0,0,1,44.773,21.233Z"/><path fill="#b9bfcc" d="M56.435,11.508a.5.5,0,0,1-.368-.839l.179-.194-.635.366a.5.5,0,0,1-.664-.713l1.139-1.682L54.267,9.5a.5.5,0,0,1-.624-.765l.693-.78-1.024.591a.5.5,0,0,1-.63-.757l.806-.946L52.3,7.526a.5.5,0,0,1-.631-.756l.81-.952-1.2.691a.5.5,0,0,1-.619-.771l.6-.653-.89.514a.5.5,0,0,1-.665-.712l1.143-1.7L49.265,4.1a.5.5,0,0,1-.653-.73l.636-.863a.5.5,0,0,1-.235-.933L50.709.6a.5.5,0,0,1,.652.729l-.525.714,1.382-.8a.5.5,0,0,1,.665.712l-1.144,1.7L53.571,2.6a.5.5,0,0,1,.619.77l-.6.655.891-.515a.5.5,0,0,1,.631.757l-.808.95,1.194-.69a.5.5,0,0,1,.631.757l-.807.948,1.193-.689a.5.5,0,0,1,.624.765l-.694.78,1.024-.591a.5.5,0,0,1,.616.092.5.5,0,0,1,.048.621L57,8.888l1.6-.924a.5.5,0,0,1,.617.771l-.345.374a.5.5,0,0,1,.238.933l-2.421,1.4A.493.493,0,0,1,56.435,11.508Z"/><path fill="#b9bfcc" d="M50.289,29.565a.5.5,0,0,1-.425-.763l1.188-1.908-1.979,1.141a.5.5,0,0,1-.666-.709l1.155-1.738L47.7,26.662a.5.5,0,0,1-.632-.756l.825-.972-1.219.7a.5.5,0,0,1-.618-.771l.591-.644-.879.507a.5.5,0,0,1-.665-.712l1.143-1.69L44.42,23.382a.5.5,0,0,1-.648-.736l1.017-1.332-1.545.892a.5.5,0,0,1-.61-.779L43.046,21l-.64.369a.5.5,0,0,1-.666-.709L42.9,18.921,41.034,20a.5.5,0,0,1-.654-.727L41.454,17.8l-1.662.959a.5.5,0,0,1-.6-.788l.179-.177-.344.2a.5.5,0,0,1-.66-.718l1.117-1.6-1.758,1.015a.5.5,0,0,1-.607-.784l.313-.317-.512.295a.5.5,0,0,1-.606-.784l.3-.307-.5.288a.5.5,0,0,1-.622-.766l.662-.737-.978.565a.5.5,0,0,1-.628-.106.5.5,0,0,1-.015-.637l.968-1.228-1.455.84a.5.5,0,0,1-.643-.742l.966-1.226-1.453.839a.5.5,0,0,1-.671-.7l1.175-1.828L31.5,10.458a.5.5,0,0,1-.674-.7l1.13-1.812a.5.5,0,0,1-.391-.912l1.61-.93a.5.5,0,0,1,.674.7L32.73,8.591,34.7,7.452a.5.5,0,0,1,.671.7L34.2,9.983l1.923-1.11a.5.5,0,0,1,.643.742L35.8,10.841,37.254,10a.5.5,0,0,1,.642.742l-.967,1.23,1.456-.841a.5.5,0,0,1,.622.766l-.662.737.978-.565a.5.5,0,0,1,.606.784l-.3.307.5-.288a.5.5,0,0,1,.606.783l-.312.318.512-.295a.5.5,0,0,1,.66.718L40.475,16l1.758-1.015a.5.5,0,0,1,.6.789l-.179.176.344-.2a.5.5,0,0,1,.654.728L42.58,17.948l1.661-.959a.5.5,0,0,1,.666.709l-1.154,1.739,1.861-1.075a.5.5,0,0,1,.611.78l-.413.427.64-.369a.5.5,0,0,1,.648.737l-1.017,1.331,1.545-.892a.5.5,0,0,1,.664.713l-1.143,1.688,1.827-1.053a.5.5,0,0,1,.618.77L49,23.14l.882-.509a.5.5,0,0,1,.632.756l-.824.971,1.217-.7a.5.5,0,0,1,.666.709L50.42,26.1l1.861-1.075a.5.5,0,0,1,.675.7l-1.187,1.908,1.3-.749a.5.5,0,1,1,.5.865L50.539,29.5A.489.489,0,0,1,50.289,29.565Z"/><path fill="#31b5a5" d="M22.807,48.152a.5.5,0,0,1-.288-.909l.47-.331-1.3.748a.5.5,0,0,1-.541-.839l8.16-5.854-9.355,5.4a.5.5,0,0,1-.521-.852l5.458-3.537L18.98,45.391a.5.5,0,0,1-.518-.855l2.922-1.863-3.247,1.874a.5.5,0,0,1-.525-.851l7.413-4.878-8,4.619a.5.5,0,0,1-.516-.856L16.8,42.4l-.518.3a.5.5,0,0,1-.517-.855l1.082-.684-1.334.77a.5.5,0,0,1-.525-.851l6.7-4.4-7.246,4.183A.5.5,0,0,1,13.928,40l2.406-1.541-2.641,1.524a.5.5,0,0,1-.542-.839l7.953-5.71-8.32,4.8a.5.5,0,0,1-.545-.836l6.706-4.9L12.6,36.167a.5.5,0,0,1-.537-.842l3.637-2.55-2.159,1.246a.5.5,0,0,1-.554-.83l4.738-3.622a.5.5,0,0,1-.44-.856l4.2-3.9a.5.5,0,0,1,.244-.518l.877-.506a.5.5,0,0,1,.59.8l-1.985,1.844,2.554-1.474a.5.5,0,0,1,.553.83l-4.578,3.5,5.328-3.075a.5.5,0,0,1,.537.842l-3.636,2.548L26.482,27a.5.5,0,0,1,.545.836l-6.708,4.9,9.01-5.2a.5.5,0,0,1,.542.839l-7.953,5.711L34.708,26.7a.5.5,0,0,1,.52.854l-2.4,1.534L36.286,27.1a.5.5,0,0,1,.525.85l-6.706,4.4,7.719-4.456a.5.5,0,0,1,.518.855l-1.077.681,1.394-.8a.5.5,0,0,1,.517.856l-.3.188.483-.279a.5.5,0,0,1,.525.85l-7.411,4.877,8.006-4.623a.5.5,0,0,1,.519.855l-2.932,1.87L41.215,31.4a.5.5,0,0,1,.521.853l-5.448,3.531,1.284-.741a.5.5,0,0,1,.541.839l-8.158,5.853,2.187-1.261a.5.5,0,0,1,.538.841L29.788,43.35a.5.5,0,0,1-.015.857l-6.716,3.878A.491.491,0,0,1,22.807,48.152Z"/><path fill="#262626" d="M12.869,32.95a5.509,5.509,0,0,0-.048,7.116c.066.077.14.148.207.225a4.265,4.265,0,0,0-1.577,2.738,3.306,3.306,0,0,0,.735,2.308,11.26,11.26,0,0,0,.828.851L2.005,57.2.4,58.8a.393.393,0,0,0,.179.667A1.04,1.04,0,0,0,1.6,59.2l11.29-11.291.921-.92.26.26a3.885,3.885,0,0,0,4.132.744,4.568,4.568,0,0,0,1.521-1.044,6,6,0,0,0,8.137-.61c1.275-1.261,2.536-2.536,3.8-3.8L44.519,29.677l2.7-2.7q1.18,1.18,2.362,2.362c1.257.96,2.561-.1,3.453-.991.733-.733,1.7-1.478.83-2.529-.956-1.152-2.163-2.164-3.22-3.221l-3.229-3.229,8.123-8.125a3.339,3.339,0,0,0,3.293-.589.994.994,0,0,0,.212-.165,2.3,2.3,0,0,0-.066-3.29c-.532-.539-1.071-1.071-1.607-1.607C55.994,4.216,54.626,2.83,53.24,1.462a3.111,3.111,0,0,0-3.787-.311,2.347,2.347,0,0,0-.83,3.437L40.63,12.582Q39.287,11.241,37.947,9.9C36.852,8.8,35.8,7.54,34.6,6.556a2.226,2.226,0,0,0-2.845.3c-.715.644-2.333,1.828-1.686,2.925a5.235,5.235,0,0,0,.861.912l1.977,1.977.111.11L20.936,24.864,14.1,31.7C13.688,32.112,13.248,32.509,12.869,32.95Zm5.039,14.208a1.768,1.768,0,0,1-1.153.186,2.52,2.52,0,0,1-1.345-.7l-1.1-1.1A5.151,5.151,0,0,1,13.174,44.2a2.748,2.748,0,0,1,.189-2.691,3.336,3.336,0,0,1,.372-.448c1.663,1.789,3.485,3.465,5.225,5.175A4.441,4.441,0,0,1,17.908,47.158ZM41.685,30.807c-1.256-.93-2.059-2.351-3.442-3.149a7.575,7.575,0,0,0-5.621-.727,20.494,20.494,0,0,1-2.405.673,6.064,6.064,0,0,1-3.611-.807,7.69,7.69,0,0,1-1.925-1.722,7.024,7.024,0,0,0-1.091-1.16l2.873-2.873,1.952,1.951.369.37c.069.068.3.049.369.043a2.1,2.1,0,0,0,.564-.127c.113-.043.613-.229.433-.408l-2.6-2.6-.162-.161L29.808,17.7l.362-.362,1.952,1.952.37.37c.068.068.3.05.368.044a2.067,2.067,0,0,0,.565-.127c.113-.043.613-.229.432-.41l-2.6-2.6-.162-.162,2.748-2.748L46.341,26.151ZM49.418,5.5,54.5,10.58l-7.907,7.907L44.4,16.294l4.93-4.931.739-.738c.207-.207.172-.437-.134-.5a1.267,1.267,0,0,0-1.024.274l-5.193,5.193-.01.01L41.511,13.41Q45.465,9.456,49.418,5.5ZM49.843,2a1.108,1.108,0,0,1,.824-.652,1.7,1.7,0,0,1,1.11.534c.086.081.167.168.251.251l3.723,3.724L57.5,7.6a2.008,2.008,0,0,1,.219,2.929c-.557.515-1.158.12-1.644-.325a.67.67,0,0,0-.1-.132L50.079,4.182A1.931,1.931,0,0,1,49.843,2Zm-17.2,8.529a13.3,13.3,0,0,1-.979-.979c-.79-.981.406-1.762,1.059-2.415.036-.037.225-.277.284-.284l.007,0a1.407,1.407,0,0,0,.184.176c.016.013.029.029.043.042.109.106.215.216.322.323l1.421,1.421,4.923,4.923a.642.642,0,0,0,.126.18l5.931,5.932a.489.489,0,0,0,.137.082l.025.025,5.33,5.331a12.19,12.19,0,0,1,1.054,1.054c.447.573.245.993-.163,1.446-.247.275-.527.526-.789.788a1.867,1.867,0,0,1-.274.274A.478.478,0,0,0,51.1,29a.423.423,0,0,0-.158-.173l-3-3a.671.671,0,0,0-.125-.179L34.469,12.3c-.03-.03-.071-.033-.106-.053Q33.5,11.389,32.646,10.53ZM15.325,32.18l0,0L17.3,34.15l.369.37c.224.224.7.12.958.007.161-.072.622-.337.389-.569l-2.6-2.6-.14-.139,2.751-2.751,1.977,1.977.37.369c.229.23.7.141.961.021.168-.077.621-.355.383-.593q-1.3-1.3-2.6-2.6l-.137-.136,2.653-2.653c.093.093.187.184.276.281.275.3.531.613.8.913A6.479,6.479,0,0,0,25.8,27.606a7.771,7.771,0,0,0,5.65.287,7.723,7.723,0,0,1,2.49-.536A6.335,6.335,0,0,1,37.381,28.5c1.306.944,2.089,2.3,3.463,3.147L27.658,44.834c-.382.383-.753.782-1.15,1.15a4.241,4.241,0,0,1-5.954-.147c-2.02-2.019-4.069-4.012-6.06-6.06a4.655,4.655,0,0,1-.156-6.61C14.657,32.829,15,32.509,15.325,32.18Z"/></svg> );
   
    // ====================== Gestión de Datos de Usuario ======================
    function useUsers(){ 
        const [users,setUsers]=useLocalStorage(USERS_KEY,[]); 
        const [current,setCurrent]=useLocalStorage(CURRENT_KEY,null); 
        const saveUser=(data, autoLogin=true)=>{ 
            const safeData = {
                ...data,
                profile: {
                    ...data.profile,
                    medication: data.profile.medication || { name: '', dose: '', dayOfWeek: null },
                    medication2: data.profile.medication2 || { name: '', dose: '', frequency: 'diario', interval: 1, dayOfWeek: null }
                },
                events: data.events || []
            };
            const idx = users.findIndex(u=>u.profile?.name===safeData.profile?.name); 
            const next = [...users]; 
            if(idx>=0) next[idx]=safeData; else next.push(safeData); 
            setUsers(next); 
            if(autoLogin) setCurrent(safeData); 
        }; 
        const removeUser=(name)=>{ const next = users.filter(u=>u.profile?.name!==name); setUsers(next); if(current?.profile?.name===name) setCurrent(null) }; 
        return {users,current, setCurrent, saveUser, removeUser}; 
    }

    // ====================== Componentes de Onboarding y Selección de Usuario ======================
    const ImportUserModal = ({open,onClose,onImport})=>{ const input=React.useRef(null); const handle=(file)=>{ if(!file) return; const reader = new FileReader(); reader.onload=(e)=>{ try{ const data=JSON.parse(e.target.result); if(!data.profile?.name || !data.profile.pin) throw new Error(); data.entries = Array.isArray(data.entries)?data.entries:[]; data.events = Array.isArray(data.events)?data.events:[]; if(!data.profile.createdAt) data.profile.createdAt=new Date().toISOString(); onImport(data); }catch{ alert('Archivo JSON inválido.'); } }; reader.readAsText(file); }; return (<Modal open={open} onClose={onClose} customHeader={<LoginHeader/>}><div className="p-4"><h3 className="text-lg font-semibold text-gray-800 dark:text-white text-center mb-4">Importar usuario desde JSON</h3><div className="rounded-lg border-2 border-dashed border-gray-400 p-8 text-center space-y-3"><p className="text-lg text-gray-800 dark:text-white">Arrastra tu archivo aquí</p><p className="text-sm text-gray-500 dark:text-gray-300">o selecciona desde el explorador</p><Button variant="outline" onClick={()=>input.current.click()}>Seleccionar archivo</Button><input ref={input} type="file" accept=".json,application/json" className="hidden" onChange={(e)=>handle(e.target.files[0])}/></div></div></Modal>); };
    const UserSelect = ({users,onChoose,onCreate,onImport, onDelete})=>{ return (<div className="min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50 dark:bg-slate-900"><Modal open={true} onClose={()=>{}} size="lg" customHeader={<LoginHeader/>}><div className="p-4"><h3 className="text-lg font-semibold text-gray-800 dark:text-white text-center mb-4">Seleccionar usuario</h3><div className="grid grid-cols-1 md:grid-cols-2 gap-4">{users.map((u)=>(<Card key={u.profile.name} className="cursor-pointer hover:shadow-lg transition" onClick={()=>onChoose(u)}><div className="flex items-start justify-between"><h4 className="text-lg font-semibold text-gray-800 dark:text-white">{u.profile.name}</h4><button className="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" onClick={(e)=>{e.stopPropagation(); onDelete(u.profile.name)}} title="Eliminar"><TrashIcon className="w-5 h-5"/></button></div><p className="text-sm text-gray-600 dark:text-gray-300 mt-1">Registros: {u.entries?.length||0}</p></Card>))}</div><div className="mt-4 flex flex-wrap gap-3 justify-end"><Button onClick={onCreate}>Crear nuevo usuario</Button><Button variant="outline" onClick={onImport}>Importar desde JSON</Button></div></div></Modal></div>);};
    const Onboarding = ({onDone,onCancel})=>{ 
        const [form,setForm]=React.useState({name:'', age:'', biology: 'hombre', height:'', startWeight:'', targetWeight:'', pin:'', pin2:'', med1_name:'', med1_dose:'', med1_day:'', med2_name:'', med2_dose:'', med2_freq: 'diario', med2_interval: 1, med2_day: 'lunes' }); 
        const change = (k,v)=>setForm(s=>({...s,[k]:v})); 
        const submit=()=>{ if(!form.name.trim() || !form.startWeight || !form.targetWeight || form.pin.length!==4 || form.pin!==form.pin2) return alert('Por favor, completa todos los campos requeridos y asegúrate de que los PIN coincidan.'); 
            const data = { 
                profile:{ 
                    name:form.name.trim(), age:parseInt(form.age||'0'), biology: form.biology, height:parseInt(form.height||'0'), startWeight:parseFloat(form.startWeight), targetWeight:parseFloat(form.targetWeight), pin:form.pin, createdAt:new Date().toISOString(), dietStartDate:new Date().toISOString(), 
                    medication:{name:form.med1_name||'', dose:form.med1_dose||'', dayOfWeek:form.med1_day||null}, 
                    medication2:{name:form.med2_name||'', dose:form.med2_dose||'', frequency: form.med2_freq, interval: parseInt(form.med2_interval) || 1, dayOfWeek: form.med2_day } 
                }, 
                entries:[], events: [] 
            }; 
            onDone(data); 
        }; 
        return (<div className="min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50 dark:bg-slate-900"><Modal open={true} onClose={onCancel} size="lg" customHeader={<LoginHeader/>}><div className="p-4 space-y-4"><h3 className="text-lg font-semibold text-gray-800 dark:text-white text-center">Crear nuevo usuario</h3><div><h4 className="font-semibold mb-2 text-gray-800 dark:text-white">Datos Personales y de Acceso</h4><div className="grid grid-cols-1 md:grid-cols-3 gap-3 border-t-2 pt-3 dark:border-gray-600"><Input containerClassName="md:col-span-1" label="Nombre" value={form.name} onChange={(e)=>change('name',e.target.value)}/><Input containerClassName="md:col-span-1" label="Edad" type="number" value={form.age} onChange={(e)=>change('age',e.target.value)}/><Select containerClassName="md:col-span-1" label="Biología" options={[{value:'hombre', label:'Hombre'}, {value:'mujer', label:'Mujer'}]} value={form.biology} onChange={e=>change('biology', e.target.value)}/><Input containerClassName="md:col-span-1" label="Altura (cm)" type="number" value={form.height} onChange={(e)=>change('height',e.target.value)}/><Input containerClassName="md:col-span-1" label="Peso inicial (kg)" type="number" step="0.1" value={form.startWeight} onChange={(e)=>change('startWeight',e.target.value)}/><Input containerClassName="md:col-span-1" label="Peso objetivo (kg)" type="number" step="0.1" value={form.targetWeight} onChange={(e)=>change('targetWeight',e.target.value)}/><Input containerClassName="md:col-span-1" label="PIN (4 dígitos)" type="password" maxLength={4} value={form.pin} onChange={(e)=>change('pin',e.target.value.replace(/[^0-9]/g,''))}/><Input containerClassName="md:col-span-2" label="Confirmar PIN" type="password" maxLength={4} value={form.pin2} onChange={(e)=>change('pin2',e.target.value.replace(/[^0-9]/g,''))}/></div></div><div><h4 className="font-semibold mb-2 text-gray-800 dark:text-white">Medicación (Opcional)</h4><div className="space-y-3 border-t-2 pt-3 dark:border-gray-600"><div className="grid grid-cols-1 md:grid-cols-3 gap-3"><Input label="Medicación 1 (Inyección)" value={form.med1_name} onChange={(e)=>change('med1_name',e.target.value)}/><Input label="Dosis 1" value={form.med1_dose} onChange={(e)=>change('med1_dose',e.target.value)}/><Select label="Día Inyección 1" options={[{value:'',label:'—'},...['lunes','martes','miércoles','jueves','viernes','sábado','domingo'].map(d=>({value:d,label:d[0].toUpperCase()+d.slice(1)}))]} value={form.med1_day} onChange={(e)=>change('med1_day',e.target.value)}/></div><div className="grid grid-cols-1 md:grid-cols-3 gap-3"><Input label="Medicación 2 (Oral)" value={form.med2_name} onChange={(e)=>change('med2_name',e.target.value)}/><Input label="Dosis 2" value={form.med2_dose} onChange={(e)=>change('med2_dose',e.target.value)}/><div className="flex items-end gap-2"><Select containerClassName="flex-grow" label="Frecuencia Toma 2" options={[{value:'diario',label:'Cada'}, {value:'semanal',label:'Semanal'}]} value={form.med2_freq} onChange={(e)=>change('med2_freq',e.target.value)}/>{form.med2_freq === 'diario' ? <><Input type="number" value={form.med2_interval} onChange={e=>change('med2_interval', e.target.value)} className="w-20"/><span className="pb-2">días</span></> : <Select containerClassName="flex-grow" options={['lunes','martes','miércoles','jueves','viernes','sábado','domingo'].map(d=>({value:d,label:d[0].toUpperCase()+d.slice(1)}))} value={form.med2_day} onChange={(e)=>change('med2_day',e.target.value)}/>}</div></div></div></div><div className="mt-4 flex justify-between"><Button variant="secondary" onClick={onCancel}>Cancelar</Button><Button onClick={submit}>Crear</Button></div></div></Modal></div>);
    };

    // --- Componentes de la App Principal ---
    const EventModal = ({ open, onClose, date, onSave, onDelete, existingEvent }) => {
      const [type, setType] = React.useState('especial');
      const [frequency, setFrequency] = React.useState('unico');

      React.useEffect(() => {
        if (open) { 
          if (existingEvent) {
            setType(existingEvent.type || 'especial');
            setFrequency(existingEvent.frequency || 'unico');
          } else {
            setType('especial');
            setFrequency('unico');
          }
        }
      }, [existingEvent, open]);

      const handleSubmit = () => {
        const eventData = { id: existingEvent ? existingEvent.id : Date.now(), date, type, frequency };
        onSave(eventData);
        onClose();
      };
      
      const handleDelete = () => {
          if (confirm('¿Estás seguro de que quieres eliminar este evento?')) {
            onDelete(existingEvent.id);
            onClose();
          }
      };
      
      const eventOptions = [
        { value: 'especial', label: 'Día especial', icon: <StarIcon className="w-5 h-5 text-yellow-400 dark:text-yellow-300"/> },
        { value: 'medico', label: 'Visita Médica', icon: <MedicalVisitIcon className="w-5 h-5 text-red-500 dark:text-red-400"/> },
        { value: 'analisis', label: 'Control/análisis', icon: <AnalysisIcon className="w-5 h-5 text-blue-500 dark:text-blue-400"/> },
        { value: 'bebida', label: 'Batido/infusión', icon: <DrinkIcon className="w-5 h-5 text-green-500 dark:text-green-400"/> }
      ];

      return (
        <Modal open={open} onClose={onClose} size="md">
          <div className="flex items-center justify-between border-b-2 border-gray-300 dark:border-gray-600 p-4">
            <h3 className="text-lg font-semibold text-gray-800 dark:text-white">{existingEvent ? 'Editar Evento' : 'Añadir Evento'} del {new Date(date + 'T00:00:00').toLocaleDateString('es-ES', { day: '2-digit', month: 'long' })}</h3>
            <button onClick={onClose} className="px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-slate-700">✕</button>
          </div>
          <div className="p-4 space-y-4">
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
              {eventOptions.map(opt => (
                <button key={opt.value} onClick={() => setType(opt.value)} className={`flex items-center gap-3 p-3 rounded-lg border-2 transition ${type === opt.value ? 'bg-blue-100 dark:bg-blue-900/50 border-blue-500' : 'bg-gray-50 dark:bg-slate-700 border-gray-400 dark:border-gray-600'}`}>
                  {opt.icon}
                  <span className="font-semibold text-gray-800 dark:text-gray-100">{opt.label}</span>
                </button>
              ))}
            </div>
            <Select label="Frecuencia del Evento" value={frequency} onChange={e => setFrequency(e.target.value)}
              options={[
                { value: 'unico', label: 'Evento único' },
                { value: 'diario', label: 'Diario' },
                { value: 'semanal', label: 'Semanal' },
                { value: 'quincenal', label: 'Quincenal' },
                { value: 'mensual', label: 'Mensual' },
              ]}
            />
            <div className="flex justify-between items-center gap-2 pt-2">
              {existingEvent ? <Button variant="danger" onClick={handleDelete} type="button">Eliminar</Button> : <div/>}
              <div className="flex gap-2">
                <Button variant="secondary" onClick={onClose}>Cancelar</Button>
                <Button onClick={handleSubmit}>Guardar</Button>
              </div>
            </div>
          </div>
        </Modal>
      );
    };

    const DayModal = ({open, onClose, date, data, onSave, onDelete, onOpenEventModal})=>{
      const [form,setForm]=React.useState({weight:'', glucose:'', exerciseTime:'0min', exerciseType: 'fuerza', sleep:'7h', fasting:'0h', diet:'correcta', water:'1.5L'});
      const isExistingEntry = React.useMemo(() => data.entries.some(e => e.date === date), [open, date, data]);

      React.useEffect(()=>{
        if(!open || !date) return;
        const sameDay = data.entries.find(e=>e.date===date);
        const yesterday = new Date(new Date(date).setDate(new Date(date).getDate() - 1));
        const prevDay = data.entries.slice().reverse().find(e => new Date(e.date) <= yesterday);
        if (sameDay) { setForm({ weight: sameDay.weight ?? '', glucose: sameDay.glucose ?? '', exerciseTime: sameDay.exerciseTime || '0min', exerciseType: sameDay.exerciseType || 'fuerza', sleep: sameDay.sleep || '7h', fasting: sameDay.fasting || '0h', diet: sameDay.diet || 'correcta', water: sameDay.water || '1.5L' }); } 
        else { setForm({ weight: prevDay?.weight ?? '', glucose: prevDay?.glucose ?? '', exerciseTime: prevDay?.exerciseTime || '0min', exerciseType: prevDay?.exerciseType || 'fuerza', sleep: prevDay?.sleep || '7h', fasting: prevDay?.fasting || '0h', diet: prevDay?.diet || 'correcta', water: prevDay?.water || '1.5L' }); }
      },[open,date,data]);
      
      const change=(k,v)=>setForm(s=>({...s,[k]:v}));
      const submit=(e)=>{ e.preventDefault(); onSave(date,{ ...form, weight: form.weight!=='' ? parseFloat(form.weight) : null, glucose: form.glucose!=='' ? parseFloat(form.glucose) : null }); onClose(); };
      const handleDelete = () => { if(confirm('¿Estás seguro de que quieres eliminar todos los datos de este día?')) { onDelete(date); onClose(); } };

      return (<Modal open={open} onClose={onClose} size="md">
        <div className="flex items-center justify-between border-b-2 border-gray-300 dark:border-gray-600 p-4">
            <h3 className="text-lg font-semibold text-gray-800 dark:text-white">{`Registro del ${new Date(date+'T00:00:00').toLocaleDateString('es-ES',{weekday:'long',day:'2-digit',month:'long'})}`}</h3>
            <button onClick={onClose} className="px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-slate-700">✕</button>
        </div>
        <div className="p-4">
            <form onSubmit={submit} className="space-y-3">
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <Input label="Peso (kg)" type="number" step="0.1" value={form.weight} onChange={(e)=>change('weight',e.target.value)}/>
                  <Input label="Glucosa (mg/dl)" type="number" value={form.glucose} onChange={(e)=>change('glucose',e.target.value)}/>
              </div>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <Select label="Tiempo de Ejercicio" options={EXERCISE_TIME} value={form.exerciseTime} onChange={(e)=>change('exerciseTime',e.target.value)}/>
                  <Select label="Tipo de Ejercicio" options={EXERCISE_TYPE} value={form.exerciseType} onChange={(e)=>change('exerciseType',e.target.value)}/>
              </div>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <Select label="Consumo de agua" options={WATER} value={form.water} onChange={(e)=>change('water',e.target.value)}/>
                  <Select label="Horas de sueño" options={SLEEP} value={form.sleep} onChange={(e)=>change('sleep',e.target.value)}/>
              </div>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <Select label="Calidad de la dieta" options={DIET} value={form.diet} onChange={(e)=>change('diet',e.target.value)}/>
                  <Select label="Tipo de ayuno" options={FASTING} value={form.fasting} onChange={(e)=>change('fasting',e.target.value)}/>
              </div>
              <div className="pt-2 border-t-2 dark:border-gray-600">
                <Button variant="outline" type="button" onClick={onOpenEventModal} className="w-full">
                    Añadir / Ver Otros Eventos
                </Button>
              </div>
              <div className="flex justify-between items-center gap-2 pt-2">
                  {isExistingEntry ? <Button variant="danger" onClick={handleDelete} type="button">Eliminar Registro</Button> : <div/>}
                  <div className="flex gap-2">
                      <Button variant="secondary" onClick={onClose}>Cancelar</Button>
                      <Button type="submit">Guardar</Button>
                  </div>
              </div>
            </form>
        </div>
      </Modal>);
    };
    const CalendarView = ({user, setUser, date})=>{
      const [dayModalDate, setDayModalDate] = React.useState(null);
      const [eventModalDate, setEventModalDate] = React.useState(null);
      const [editingEvent, setEditingEvent] = React.useState(null);

      const med1Day = (()=>{const m={lunes:1,martes:2,miércoles:3,jueves:4,viernes:5,sábado:6,domingo:0};return m[(user.profile.medication?.dayOfWeek||'').toLowerCase()]??null;})();
      
      const isMed2Day = (day) => {
        const med2 = user.profile.medication2;
        if (!med2 || !med2.name) return false;
        
        const dayDate = new Date(day);
        dayDate.setHours(0,0,0,0);
        
        const dietStartDate = new Date(user.profile.dietStartDate || user.profile.createdAt);
        dietStartDate.setHours(0,0,0,0);
        if (dayDate < dietStartDate) return false;
        
        if (med2.frequency === 'diario') {
            const diffTime = Math.abs(dayDate - dietStartDate);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            return diffDays % (med2.interval || 1) === 0;
        } else if (med2.frequency === 'semanal') {
            const weekDays = {'lunes':1,'martes':2,'miércoles':3,'jueves':4,'viernes':5,'sábado':6,'domingo':0};
            return day.getDay() === weekDays[med2.dayOfWeek];
        }
        return false;
      };

      const handleOpenEventModal = (day) => {
        const dateStr = fmt(day);
        const dayEvents = getEventsForDay(day);
        setDayModalDate(null);
        setEventModalDate(dateStr);
        setEditingEvent(dayEvents.length > 0 ? dayEvents[0] : null);
      };
      
      const saveEntry=(d,p)=>{ const e=[...user.entries]; const i=e.findIndex(x=>x.date===d); const nE={...(e[i]||{}),date:d,...p}; if(i>=0)e[i]=nE; else e.push(nE); e.sort((a,b)=>new Date(a.date)-new Date(b.date)); setUser({...user,entries:e}); };
      const removeEntry=(d)=>{ const updatedEntries = user.entries.filter(e => e.date !== d); setUser({...user, entries: updatedEntries}); };
      
      const saveEvent = (eventData) => {
        const events = [...(user.events || [])];
        const index = events.findIndex(e => e.id === eventData.id);
        if (index > -1) { events[index] = eventData; } else { events.push(eventData); }
        setUser({ ...user, events });
      };

      const deleteEvent = (eventId) => {
        const events = (user.events || []).filter(e => e.id !== eventId);
        setUser({ ...user, events });
      };

      const getEventsForDay = (day) => {
        const events = user.events || [];
        const dayOfWeek = day.getDay();
        const dateOfMonth = day.getDate();
        const dayDate = new Date(day);
        dayDate.setHours(0,0,0,0);

        return events.filter(event => {
            const eventDate = new Date(event.date);
            eventDate.setHours(0,0,0,0);
            if (dayDate < eventDate) return false;

            switch (event.frequency) {
                case 'unico': return event.date === fmt(day);
                case 'diario': return true;
                case 'semanal': return dayOfWeek === eventDate.getDay();
                case 'quincenal':
                    const diffTime = Math.abs(dayDate - eventDate);
                    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                    return diffDays % 14 === 0;
                case 'mensual': return dateOfMonth === eventDate.getDate();
                default: return false;
            }
        });
      };

      const firstOfMonth = new Date(date.getFullYear(), date.getMonth(), 1);
      const lastOfMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0);
      const firstDayOfWeek = (firstOfMonth.getDay() + 6) % 7;
      const calendarStart = new Date(firstOfMonth);
      calendarStart.setDate(firstOfMonth.getDate() - firstDayOfWeek);
      const lastDayOfWeek = (lastOfMonth.getDay() + 6) % 7;
      const calendarEnd = new Date(lastOfMonth);
      calendarEnd.setDate(lastOfMonth.getDate() + (6 - lastDayOfWeek));

      const days = [];
      for (let d = new Date(calendarStart); d <= calendarEnd; d.setDate(d.getDate() + 1)) {
          days.push(new Date(d));
      }
      
      const EventIcon = ({type, className}) => {
        const iconClasses = `w-5 h-5 ${className}`;
        switch (type) {
            case 'especial': return <StarIcon className={iconClasses} />;
            case 'medico': return <MedicalVisitIcon className={iconClasses} />;
            case 'analisis': return <AnalysisIcon className={iconClasses} />;
            case 'bebida': return <DrinkIcon className={iconClasses} />;
            default: return null;
        }
      };

      const WeeklyLossAnnotation = ({ day, entries, profile }) => {
        if (day.getDay() !== 0) return null;
        const allEntriesSorted = [...entries].sort((a, b) => new Date(a.date) - new Date(b.date));
        if (allEntriesSorted.length === 0) return null;
        const firstEntryDate = new Date(allEntriesSorted[0].date + 'T00:00:00');
        const thisSunday = new Date(day);
        thisSunday.setHours(23, 59, 59, 999);
        if (thisSunday < firstEntryDate) return null;
        const lastEntryThisWeek = allEntriesSorted.filter(e => e.weight != null && new Date(e.date + 'T00:00:00') <= thisSunday).pop();
        if (!lastEntryThisWeek) return null;
        const previousSunday = new Date(thisSunday);
        previousSunday.setDate(thisSunday.getDate() - 7);
        let weightToCompare;
        if (previousSunday < firstEntryDate) {
            weightToCompare = profile.startWeight;
        } else {
            const lastEntryPrevWeek = allEntriesSorted.filter(e => e.weight != null && new Date(e.date + 'T00:00:00') <= previousSunday).pop();
            if (!lastEntryPrevWeek) return null;
            weightToCompare = lastEntryPrevWeek.weight;
        }
        const currentWeight = lastEntryThisWeek.weight;
        const totalChange = weightToCompare - currentWeight;
        if (Math.abs(totalChange) < 0.05) return null;
        const isLoss = totalChange > 0;
        const color = isLoss ? "#ef4444" : "#22c55e";
        const symbol = isLoss ? "-" : "+";
        const value = Math.abs(totalChange).toFixed(1).replace('.', ',');
        return (
            <div className="absolute top-1 right-1 w-12 h-12 flex items-center justify-center pointer-events-none">
                <svg viewBox="0 0 100 100" className="absolute w-full h-full">
                    <path d="M 50,5 A 45,45 0 1,1 49.9,5.01 Z" stroke={color} strokeWidth="4" fill="none" transform="rotate(-15 50 50)" />
                </svg>
                <span className="font-handwriting text-black dark:text-white text-xl font-bold z-10">{symbol}{value}</span>
            </div>
        );
      };

      return(<div className="space-y-4">
        <Card>
            <div className="flex flex-col md:grid md:grid-cols-7 gap-2">
                <div className="hidden md:grid md:grid-cols-7 col-span-7 gap-1 md:gap-2">
                    {['Lun','Mar','Mié','Jue','Vie','Sáb','Dom'].map(h=><div key={h} className="text-center font-semibold text-gray-600 dark:text-gray-300 py-2">{h}</div>)}
                </div>
                {days.map((d,i)=>{ 
                    const isCurrentMonth = d.getMonth() === date.getMonth();
                    const dayString = fmt(d);
                    const entry = user.entries.find(e=>e.date===dayString); 
                    const prevEntry = user.entries.filter(e=>e.weight!=null&&e.date<dayString).pop(); 
                    const diff = entry?.weight!=null&&prevEntry?.weight!=null?entry.weight-prevEntry.weight:null; 
                    const exerciseLabel = EXERCISE_TIME.find(opt => opt.value === entry?.exerciseTime)?.label || '';
                    const eventsOnDay = getEventsForDay(d);
                    const specialEvent = eventsOnDay.find(e => e.type === 'especial');
                    const otherEvents = eventsOnDay.filter(e => e.type !== 'especial');

                    return(
                        <button key={i} onClick={()=>setDayModalDate(dayString)} className={`relative rounded-lg calendar-cell p-2 text-left hover:shadow-lg transition-all duration-200 flex flex-col items-start justify-start md:h-32 ${dayString===fmt(new Date())?'ring-2 ring-blue-500 border-blue-500':''} ${!isCurrentMonth ? 'opacity-60 hover:opacity-100' : ''}`}>
                            <div className="flex items-center gap-1">
                                <span className="text-sm font-medium text-gray-700 dark:text-gray-200">{d.getDate()}</span>
                                {specialEvent && <EventIcon type="especial" className="text-yellow-400 dark:text-yellow-300"/>}
                            </div>
                            
                            <div className="mt-1 flex-grow">
                                {entry?.weight!=null && (
                                    <>
                                        <div className="text-xl font-bold text-gray-800 dark:text-white leading-5">{entry.weight.toFixed(1)} kg</div>
                                        {diff!=null && <div className={`text-xs font-semibold ${diff<0?'text-green-600':(diff>0?'text-red-600':'text-gray-500')}`}>{diff<0?'▼':(diff>0?'▲':'▬')} {Math.abs(diff).toFixed(1)} kg</div>}
                                    </>
                                )}
                            </div>
                            
                            <div className="w-full mt-auto">
                                <div className="hidden md:flex items-center justify-end gap-1.5 flex-wrap">
                                    {entry?.exerciseTime && entry.exerciseTime !== '0min' && <span className="text-xs text-gray-500 dark:text-gray-400">{exerciseLabel}</span>}
                                    {entry?.exerciseTime && entry.exerciseTime !== '0min' && (entry.exerciseType === 'anaerobico' ? <AnaerobicIcon className="w-5 h-5 text-gray-700 dark:text-gray-200"/> : <WeightlifterIcon className="w-5 h-5 text-gray-700 dark:text-gray-200"/>)}
                                    {med1Day === d.getDay() && user.profile.medication?.name && <InjectionIcon className="w-5 h-5"/>}
                                    {isMed2Day(d) && user.profile.medication2?.name && <PillIcon className="w-5 h-5"/>}
                                    {otherEvents.slice(0, 4).map(e => <EventIcon key={e.id} type={e.type} />)}
                                </div>
                                <div className="absolute bottom-1.5 right-1.5 flex md:hidden items-center justify-end gap-1.5">
                                    {entry?.exerciseTime && entry.exerciseTime !== '0min' && <span className="text-xs text-gray-500 dark:text-gray-400">{exerciseLabel}</span>}
                                    {entry?.exerciseTime && entry.exerciseTime !== '0min' && (entry.exerciseType === 'anaerobico' ? <AnaerobicIcon className="w-5 h-5 text-gray-700 dark:text-gray-200"/> : <WeightlifterIcon className="w-5 h-5 text-gray-700 dark:text-gray-200"/>)}
                                    {med1Day === d.getDay() && user.profile.medication?.name && <InjectionIcon />}
                                    {isMed2Day(d) && user.profile.medication2?.name && <PillIcon className="w-5 h-5"/>}
                                    {otherEvents.slice(0, 3).map(e => <EventIcon key={e.id} type={e.type} />)}
                                </div>
                            </div>
                            
                            <WeeklyLossAnnotation day={d} entries={user.entries} profile={user.profile} />
                        </button>
                    );
                })}
            </div>
        </Card>
        {dayModalDate && <DayModal open={!!dayModalDate} onClose={()=>setDayModalDate(null)} date={dayModalDate} data={user} onSave={saveEntry} onDelete={removeEntry} onOpenEventModal={() => handleOpenEventModal(new Date(dayModalDate))} />}
        {eventModalDate && <EventModal open={!!eventModalDate} onClose={() => setEventModalDate(null)} date={eventModalDate} onSave={saveEvent} onDelete={deleteEvent} existingEvent={editingEvent} />}
      </div>);
    };

    const MilestoneIndicator = ({label, position}) => (
      <div className="absolute transition-transform duration-500" style={{top: 'calc(100% + 0.5rem)', left: `${position}%`, transform: 'translateX(-50%)'}}>
        <div className="relative flex flex-col items-center">
          <div className="mb-1 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-700 dark:border-b-gray-300"></div>
          <span className="px-2 py-0.5 bg-gray-700 text-white dark:bg-gray-300 dark:text-black text-xs font-bold rounded-md shadow-lg">{label}</span>
        </div>
      </div>
    );
    
    // ... El resto del código de la aplicación (ProgressView, ChartsView, ProfileView, App, etc.)
    const ProgressView = ({user, scenario})=>{ /* ... El código de este componente no cambia ... */ };
    const ChartsView = ({user, theme})=>{ /* ... El código de este componente no cambia ... */ };
    const ProfileView = ({user, setUser})=>{ /* ... El código de este componente no cambia ... */ };

    const App = ()=>{
      // ... El código de este componente no cambia ...
    };
    
    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js')
          .then(registration => {
            console.log('Service Worker v2 registrado:', registration.scope);
          })
          .catch(error => {
            console.log('Error al registrar Service Worker v2:', error);
          });
      });
    }
  </script>

</body>
</html>